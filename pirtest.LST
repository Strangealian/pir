A51 MACRO ASSEMBLER  PIRTEST                                                              11/02/2019 10:24:22 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN pirtest.OBJ
ASSEMBLER INVOKED BY: E:\Program Files\C51\BIN\A51.EXE pirtest.asm SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

0000                   1     DEF:
  0060                 2         LOOPTAG EQU 60H;Ê¨°Êï∞ÁªüËÆ°‰øùÂ≠òÂú∞ÂùÄ
  0059                 3         LOOPTIME EQU 59H;Âª∂Êó∂Âæ™ÁéØÊ¨°Êï∞‰øùÂ≠òÂú∞ÂùÄ
  0058                 4         OFFSET1 EQU 58H;‰∏™‰ΩçÂÅèÁßªÂú∞ÂùÄËÆ∞ÂΩï
  0057                 5         OFFSET2 EQU 57H;ÂçÅ‰ΩçÂÅèÁßªÂú∞ÂùÄËÆ∞ÂΩï
  0056                 6         BALANCE EQU 56H;Ë¥üËΩΩ ÂùáË°°Ê†áËÆ∞
  0055                 7         DEFAULTDT EQU 55H;
  00D8                 8         THT EQU 0D8H;ËÆ°Êï∞Âô®È´òÂ≠óËäÇ
  00F0                 9         TLT EQU 0F0H;ËÆ°Êï∞Âô®‰ΩéÂ≠óËäÇ
                      10     
  0054                11         KEYBUF1 EQU 54H;ÈîÆÁõòËØªÂÖ•Êï∞ÊçÆÂçÅ‰Ωç
  0053                12         KEYBUF2 EQU 53H;ÈîÆÁõòËØªÂÖ•Êï∞ÊçÆ‰∏™‰ΩçÔºõ
  0052                13         KEYBUF3 EQU 52H;
  0051                14         ADJUSTFLAG EQU 51H;
                      15     
0000                  16         ORG 0000H;
0000 0160             17         AJMP MAIN;
000B                  18         ORG 000BH;T0Ê∫¢Âá∫‰∏≠Êñ≠ÂÖ•Âè£Âú∞ÂùÄ
000B 212D             19         AJMP DELAY;
0013                  20         ORG 0013H;
0013 2188             21         AJMP KBSCN;
0060                  22         ORG 0060H;
                      23         ;!!!!JNZÈúÄË¶ÅÊõ¥Êîπ JNZ ÊòØ‰∏∫‰∫ÜÊµãËØï
                      24     
                      25     
0060                  26     MAIN:
0060 758160           27         MOV SP,#60H;
                      28         
0063 75580A           29         MOV OFFSET1,#0AH;
0066 755703           30         MOV OFFSET2,#03H;
0069 75551E           31         MOV DEFAULTDT,#30;
006C 755905           32         MOV LOOPTIME,#05H;
006F 755101           33         MOV ADJUSTFLAG,#1;
0072 755300           34         MOV KEYBUF2,#00H;
0075 D2AF             35         SETB EA;
0077 D2AA             36             SETB EX1;
0079 D28A             37             SETB IT1;
                      38         
007B D2BA             39         SETB PX1;
                      40         
007D                  41         LOOP:
007D 756000           42             MOV LOOPTAG,#00H;
0080 7556FF           43             MOV BALANCE,#0FFH;
0083 755101           44             MOV ADJUSTFLAG,#1;
                      45     
0086 7590FF           46             MOV P1,#0FFH;p1‰∏∫Êï∞ÊçÆËæìÂá∫ÔºåÁÇπ‰∫ÆLEDÁî®
0089 758000           47             MOV P0,#00H;
                      48     
008C 75B0FF           49             MOV P3,#0FFH;p3‰∏∫ÈîÆÁõòËæìÂÖ•Âè£
008F C2B7             50             CLR P3.7;
0091 75A0FF           51             MOV P2,#0FFH;p2‰Ωú‰∏∫Êï∞ÊçÆËæìÂÖ•Âè£
                      52             ;LCALL DELAY4KBD;ÊØèÁßí100Ê¨°
                      53     
                      54             ;MOV R7,#0AH;
                      55             ;DTCNSPDCNRL:;DETECTION SPEED CONTROL Ê£ÄÊµãÈÄüÂ∫¶ÊéßÂà∂
0094 D28A             56             SETB IT1;ËøõÂÖ•ÈîÆÁõò‰∏≠Êñ≠ÂêéÊääÂ§ñÈÉ®‰∏≠Êñ≠ËÆæÁΩÆ‰∏∫ÁîµÂπ≥Ëß¶ÂèëÔºåÊ∂àÈô§Êú∫Ê¢∞Èî
                             ÆÁõòÊØõÂà∫ÂΩ±ÂìçÔºõÈÄÄÂá∫‰∏≠Êñ≠ÂêéÂÜçÊÅ¢Â§çÔºõ
                      57                 
A51 MACRO ASSEMBLER  PIRTEST                                                              11/02/2019 10:24:22 PAGE     2

                      58     
0096 E5A0             59             MOV A,P2;
0098 5407             60             ANL A,#07H; 0  Êà™Âèñ‰∏â‰ΩçËæìÂÖ•‰ø°Âè∑ÔºåÂè™ÊúâËæìÂÖ•‰ø°Âè∑ÊòØ1Ôºå3Ôºå5ÊâçÁÇπ‰∫Æ
009A B40102           61             CJNE A,#01H,CMP3;
009D 01A7             62             AJMP LIGHT;
009F                  63             CMP3:
009F B40302           64                 CJNE A,#03H,CMP5;
00A2 01A7             65                 AJMP LIGHT;‰∏∫3ÔºåÁõ¥Êé•Ë∑≥ËΩ¨Âà∞LIGHT
00A4                  66             CMP5:
00A4 B405D6           67                 CJNE A,#05H,LOOP;‰∏∫5ÔºåÊâßË°åLIGHTÂê¶ÂàôËøîÂõûÁªßÁª≠ËØªÂèñP2Âè£
                      68     
00A7                  69         LIGHT:
00A7 B290             70             CPL P1.0;
00A9 00               71             NOP;
00AA 00               72             NOP;
00AB AD55             73             MOV R5,DEFAULTDT;
00AD AA57             74             MOV R2,OFFSET2;Â≠òÊîæÊï∞Á†ÅÁÆ°ÂçÅ‰ΩçÂØπÂ∫îÂÅèÁßªÂú∞ÂùÄ
00AF E551             75             MOV A,ADJUSTFLAG;
00B1 B40004           76             CJNE A,#0,ADJUST;
00B4 AB58             77             MOV R3,OFFSET1;Â≠òÊîæÊï∞Á†ÅÁÆ°‰∏™‰ΩçÂØπÂ∫îÂÅèÁßªÂú∞ÂùÄ
                      78             
00B6 01C5             79             AJMP LIGHTTIME;
00B8                  80             ADJUST:
00B8 E553             81                 MOV A,KEYBUF2;
00BA B40004           82                 CJNE A,#00H,ADJUST1;
00BD AB58             83                 MOV R3,OFFSET1;
00BF 01C5             84                 AJMP LIGHTTIME;
00C1                  85                 ADJUST1:
00C1 FB               86                 MOV R3,A;
00C2 755100           87                 MOV ADJUSTFLAG,#0;
                      88     
00C5                  89             LIGHTTIME:
00C5 120117           90                 LCALL DELAY1S;Âª∂Êó∂1sÂêéÊï∞Á†ÅÁÆ°ÊòæÁ§∫Áõ∏Â∫îÊï∞Â≠ó
00C8 D28A             91                 SETB IT1;ËøõÂÖ•ÈîÆÁõò‰∏≠Êñ≠ÂêéÊääÂ§ñÈÉ®‰∏≠Êñ≠ËÆæÁΩÆ‰∏∫ÁîµÂπ≥Ëß¶ÂèëÔºåÊ∂àÈô§Êú∫Ê
                             ¢∞ÈîÆÁõòÊØõÂà∫ÂΩ±ÂìçÔºõÈÄÄÂá∫‰∏≠Êñ≠ÂêéÂÜçÊÅ¢Â§çÔºõ
                      92     
                      93                 
                      94                 ;MOV P2,#0FFH;p2‰Ωú‰∏∫Êï∞ÊçÆËæìÂÖ•Âè£
00CA 758000           95                 MOV P0,#00H;
00CD E5A0             96                 MOV A,P2;
00CF 5407             97                 ANL A,#07H; 0  Êà™Âèñ‰∏â‰ΩçËæìÂÖ•‰ø°Âè∑ÔºåÂè™ÊúâËæìÂÖ•‰ø°Âè∑ÊòØ1Ôºå3Ôºå5ÊâçÁÇπ‰
                             ∫Æ
                      98                 ;JZ LIGHT;‰∏∫0Áõ¥Êé•Ë∑≥ËΩ¨Âà∞ÁÇπ‰∫ÆledÔºõ
00D1 B40109           99                 CJNE A,#01H,CMP3INT;
00D4 C28C            100                 CLR TR0;
00D6 C2A9            101                 CLR ET0;
00D8 755101          102                 MOV ADJUSTFLAG,#1;
00DB 01A7            103                 AJMP LIGHT;
00DD                 104                 CMP3INT:
00DD B40309          105                     CJNE A,#03H,CMP5INT;
00E0 C28C            106                     CLR TR0;
00E2 C2A9            107                     CLR ET0;
00E4 755101          108                     MOV ADJUSTFLAG,#1;
00E7 01A7            109                     AJMP LIGHT;‰∏∫2ÔºåÁõ¥Êé•Ë∑≥ËΩ¨Âà∞LIGHT
00E9                 110                 CMP5INT:
00E9 B40509          111                     CJNE A,#05H,NOINT;‰∏∫4ÔºåÊâßË°åLIGHTÂê¶ÂàôËøîÂõûÁªßÁª≠ËØªÂèñP2Âè£
00EC C28C            112                     CLR TR0;
00EE C2A9            113                     CLR ET0;
00F0 755101          114                     MOV ADJUSTFLAG,#1;
00F3 01A7            115                     AJMP LIGHT;
                     116                     
                     117     
00F5                 118                 NOINT:
00F5 1B              119                     DEC R3;
00F6 7400            120                     MOV A,#00H;
00F8 B50301          121                     CJNE A,03H,CFG;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/02/2019 10:24:22 PAGE     3

00FB 1A              122                     DEC R2;
00FC                 123                 CFG:
00FC BB0002          124                     CJNE R3,#00H,ASGTO;
00FF AB58            125                     MOV R3,OFFSET1;
0101                 126                 ASGTO:
0101 DDC2            127                     DJNZ R5,LIGHTTIME;
0103 B290            128                     CPL P1.0;
0105 C2A6            129                     CLR P2.6;
0107 D2A7            130                     SETB P2.7;
0109 758000          131                     MOV P0,#00H;
010C C2A7            132                     CLR P2.7;
010E D2A6            133                     SETB P2.6;
0110 758000          134                     MOV P0,#00H;
0113 C2A6            135                     CLR P2.6;
0115 017D            136                     AJMP LOOP;
                     137     
                     138     ;Âª∂Êó∂1sÂ≠êÁ®ãÂ∫è
0117                 139     DELAY1S:
                     140             ;PUSH PSW;
                     141             ;PUSH ACC;
                     142             ;AJMP DELAY10MS;
                     143         
                     144     
                     145     
                     146     
                     147     
                     148     
                     149     
                     150     
                     151     
                     152     
                     153     
                     154     
                     155     
                     156     
0117                 157         DELAY10MS:
0117 758901          158             MOV TMOD,#01H;ËÆ°Êï∞Âô®1Â∑•‰Ωú‰∫éÊñπÂºè1
011A 758CD8          159             MOV TH0,#THT;Âä†‰∏ÄËÆ°Êï∞Âô®È´òÂ≠óËäÇ
011D 758AF0          160             MOV TL0,#TLT;Âä†‰∏ÄËÆ°Êï∞Âô®‰ΩéÂ≠óËäÇ
                     161             ;SETB EA;
0120 D28C            162             SETB TR0;
0122 D2A9            163             SETB ET0;
                     164             
0124                 165         TIMEOUT:  
0124 AE60            166             MOV R6,LOOPTAG;
0126 BE64FB          167             CJNE R6,#64H,TIMEOUT;
0129 756000          168             MOV LOOPTAG,#00H;
                     169             ;POP ACC;
                     170             ;POP PSW;
012C 22              171             RET;
                     172     
                     173     
                     174     
                     175     
                     176     ;ËÆ°Êï∞Âô®1Ê∫¢Âá∫‰∏≠Êñ≠Âá∫Âè£
012D                 177     DELAY:
012D C0D0            178             PUSH PSW;
012F C0E0            179             PUSH ACC;
0131 AE60            180             MOV R6,LOOPTAG;
0133 0E              181             INC R6;
0134 8E60            182             MOV LOOPTAG,R6;
0136 758CD8          183             MOV TH0,#THT;Âä†‰∏ÄËÆ°Êï∞Âô®È´òÂ≠óËäÇ
0139 758AF0          184             MOV TL0,#TLT;Âä†‰∏ÄËÆ°Êï∞Âô®‰ΩéÂ≠óËäÇ
                     185     
                     186             
                     187             ;ÁÇπ‰∫ÆÊï∞Á†ÅÁÆ°
A51 MACRO ASSEMBLER  PIRTEST                                                              11/02/2019 10:24:22 PAGE     4

013C                 188         NUMDIS:
                     189         
                     190             
013C EE              191             MOV A,R6;
013D 5401            192             ANL A,#01H;
013F F556            193             MOV BALANCE,A;Ë¥üËΩΩÂùáË°°
0141 701A            194             JNZ BAL2;
0143                 195         BAL1:
0143 7CFD            196             MOV R4,#0FDH;R4Â≠òÊîæÊï∞Á†ÅÁÆ°‰ΩçÁΩÆ‰∏™‰Ωç
                     197             
                     198             ;MOV R3,A;
0145 C2A6            199             CLR P2.6;‰ΩçÈÄâÈÄâ‰∏≠‰∏™‰Ωç
0147 D2A7            200             SETB P2.7;
                     201             ;MOV P0,#0FFH;
0149 8C80            202             MOV P0,R4;
014B C2A7            203             CLR P2.7;
                     204     
014D 900372          205             MOV DPTR,#TIMETAB;
0150 EB              206             MOV A,R3;
0151 93              207             MOVC A,@A+DPTR;Êü•Ë°®ÂæóÂà∞Áõ∏Â∫îÊï∞Â≠óÂØπÂ∫îÂÄº
0152 D2A6            208             SETB P2.6;
0154 758000          209             MOV P0,#00H;
0157 F580            210             MOV P0,A;
0159 E556            211             MOV A,BALANCE;
015B 701A            212             JNZ BAL3;
                     213             ;LCALL PWNWAT;Âª∂Êó∂1ms
                     214             ;LCALL PWNWAT;
                     215             
015D                 216         BAL2:
015D 7CFE            217             MOV R4,#0FEH;
                     218         
015F 900372          219             MOV DPTR, #TIMETAB;
0162 EA              220             MOV A,R2;
0163 93              221             MOVC A,@A+DPTR;
                     222             ;CALL PWNWAT;
0164 C2A6            223             CLR P2.6;
0166 D2A7            224             SETB P2.7;
                     225             ;MOV P0,#0FFH;
0168 8C80            226             MOV P0,R4;
016A C2A7            227             CLR P2.7;
016C D2A6            228             SETB P2.6;
016E 758000          229             MOV P0,#00H;
0171 F580            230             MOV P0,A;
0173 E556            231             MOV A,BALANCE;
0175 70CC            232             JNZ BAL1;
                     233             ;LCALL PWNWAT;
0177                 234         BAL3:
0177 BE6409          235             CJNE R6,#64H,BREAK;
017A C2A6            236             CLR P2.6;
                     237             
017C C28C            238             CLR TR0;
017E C2A9            239             CLR ET0;
                     240             ;CLR EA;
0180 758900          241             MOV TMOD,#00H;
                     242             ;MOV 60H,#00H;
                     243             
0183                 244         BREAK:
0183 D0E0            245             POP ACC;
0185 D0D0            246             POP PSW;
0187 32              247             RETI;
                     248     
                     249     
                     250     
                     251     
                     252     
                     253     
A51 MACRO ASSEMBLER  PIRTEST                                                              11/02/2019 10:24:22 PAGE     5

                     254     
                     255     
                     256     
                     257     
                     258     
                     259     
                     260     
                     261     
                     262     
                     263     
                     264     
                     265     
                     266     
0188                 267     KBSCN:
                     268     
0188 B297            269             CPL P1.7;p1.7‰∏∫ÈîÆÁõò‰∏≠Êñ≠Ê†áÂøóÔºåÁÅØ‰∫ÆËØ¥ÊòéÊ≠£Á°ÆËøõÂÖ•ÈîÆÁõò‰∏≠Êñ≠ÊúçÂä°Á®ãÂ
                             ∫è
                     270             
018A 755403          271             MOV KEYBUF1,#03H;
018D 755300          272             MOV KEYBUF2,#00H;
0190 75551E          273             MOV DEFAULTDT,#30;
                     274             
0193                 275         WAT4RLS:;WAITE FOR REALSE
0193 E5B0            276             MOV A,P3;
0195 540F            277             ANL A,#0FH;
0197 640F            278             XRL A,#0FH;
0199 70F8            279             JNZ WAT4RLS;
                     280     
                     281     
                     282             
019B C0D0            283             PUSH PSW;
019D C0E0            284             PUSH ACC;
019F D2D3            285             SETB RS0;USE THE SECOND SET OF REGISTERS;
01A1 C28A            286             CLR IT1;
01A3 7900            287             MOV R1,#0;R1Áî®‰ΩúÊ†áÂøóÔºåÁî®Êù•Ê†áËÆ∞Êï∞ÊçÆÂ∫îËØ•Â≠òÂÖ•Âì™‰∏™buf„ÄÇ
                     288     
                     289         
                     290     
                     291     
                     292     
                     293     
                     294     
                     295     
                     296     
                     297     
                     298         
01A5                 299         KBSCNR1:
01A5 75B0FF          300             MOV P3,#0FFH;
01A8 C2B4            301             CLR P3.4;
01AA E5B0            302             MOV A,P3;
01AC 540F            303             ANL A,#0FH;
01AE 640F            304             XRL A,#0FH;
01B0 6016            305             JZ KBSCNR2;
                     306             
01B2 7152            307             CALL DELAY4KBD;
                     308     
01B4 E5B0            309             MOV A,P3;
01B6 540F            310             ANL A,#0FH;
01B8 640F            311             XRL A,#0FH;
01BA 600C            312             JZ KBSCNR2;
01BC                 313         C11:
01BC 00              314             NOP;
01BD                 315         C12:
01BD 00              316             NOP;
01BE                 317         C13:
01BE 00              318             NOP;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/02/2019 10:24:22 PAGE     6

01BF                 319         C14:
01BF 00              320             NOP;
                     321         
01C0                 322         WAT4RLS1:;WAITE FOR REALSE
01C0 E5B0            323             MOV A,P3;
01C2 540F            324             ANL A,#0FH;
01C4 640F            325             XRL A,#0FH;
01C6 70F8            326             JNZ WAT4RLS1;
                     327     
01C8                 328         KBSCNR2:
01C8 75B0FF          329             MOV P3,#0FFH;
01CB C2B5            330             CLR P3.5;
01CD E5B0            331             MOV A,P3;
01CF 540F            332             ANL A,#0FH;
01D1 640F            333             XRL A,#0FH;
01D3 6055            334             JZ KBSCNR3;
01D5 7152            335             CALL DELAY4KBD;
                     336     
01D7 E5B0            337             MOV A,P3;
01D9 540F            338             ANL A,#0FH;
01DB 640F            339             XRL A,#0FH;
01DD 604B            340             JZ KBSCNR3;
                     341     
01DF                 342         C21:
01DF B40113          343             CJNE A,#01H,C22;0001Â∑¶‰∏äËßíË¢´Êåâ‰∏ã
                     344             
                     345     
                     346     
01E2 B90009          347             CJNE R1,#0,C21BUF2;
01E5 755407          348             MOV KEYBUF1,#07H;
01E8 B290            349             CPL P1.0;
01EA 7901            350             MOV R1,#1;
01EC 4122            351             AJMP WAT4RLS2;
01EE                 352         C21BUF2:
01EE 755307          353             MOV KEYBUF2,#07H;
01F1 7900            354             MOV R1,#0;
01F3 4122            355             AJMP WAT4RLS2;
01F5                 356         C22:
01F5 B40211          357             CJNE A,#02H,C23;
01F8 B90007          358             CJNE R1,#0,C22BUF2;
01FB 755404          359             MOV KEYBUF1,#04H;
01FE 7901            360             MOV R1,#1;
0200 4122            361             AJMP WAT4RLS2;
0202                 362         C22BUF2:
0202 755304          363             MOV KEYBUF2,#04H;
0205 7900            364             MOV R1,#0;
0207 4122            365             AJMP WAT4RLS2;
0209                 366         C23:
0209 B40411          367             CJNE A,#04H,C24;
020C B90007          368             CJNE R1,#0,C23BUF2;
020F 755401          369             MOV KEYBUF1,#01H;
0212 7901            370             MOV R1,#1;
0214 4122            371             AJMP WAT4RLS2;
0216                 372         C23BUF2:
0216 755301          373             MOV KEYBUF2,#01H;
0219 7900            374             MOV R1,#0;
021B 4122            375             AJMP WAT4RLS2;
021D                 376         C24:
021D B40802          377             CJNE A,#08H,WAT4RLS2;
                     378             ;MOV KEYBUF1,#0FFH;
0220 611D            379             AJMP EXITSET;
                     380     
0222                 381         WAT4RLS2:;WAITE FOR REALSE
0222 E5B0            382             MOV A,P3;
0224 540F            383             ANL A,#0FH;
0226 640F            384             XRL A,#0FH;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/02/2019 10:24:22 PAGE     7

0228 70F8            385             JNZ WAT4RLS2;
                     386     
                     387     
                     388     
                     389     
022A                 390         KBSCNR3:
022A 75B0FF          391             MOV P3,#0FFH;
022D C2B6            392             CLR P3.6;
022F E5B0            393             MOV A,P3;
0231 540F            394             ANL A,#0FH;
0233 640F            395             XRL A,#0FH;
0235 6060            396             JZ KBSCNR4;
0237 7152            397             CALL DELAY4KBD;
                     398     
0239 E5B0            399             MOV A,P3;
023B 540F            400             ANL A,#0FH;
023D 640F            401             XRL A,#0FH;
023F 6056            402             JZ KBSCNR4;
                     403     
0241                 404         C31:
0241 B40111          405             CJNE A,#01H,C32;0001Â∑¶‰∏äËßíË¢´Êåâ‰∏ã
0244 B90007          406             CJNE R1,#0,C31BUF2;
0247 755408          407             MOV KEYBUF1,#08H;
024A 7901            408             MOV R1,#1;
024C 418F            409             AJMP WAT4RLS3;
024E                 410         C31BUF2:
024E 755308          411             MOV KEYBUF2,#08H;
0251 7900            412             MOV R1,#0;
0253 418F            413             AJMP WAT4RLS3;
0255                 414         C32:
0255 B40211          415             CJNE A,#02H,C33;
0258 B90007          416             CJNE R1,#0,C32BUF2;
025B 755405          417             MOV KEYBUF1,#05H;
025E 7901            418             MOV R1,#1;
0260 418F            419             AJMP WAT4RLS3;
0262                 420         C32BUF2:
0262 755305          421             MOV KEYBUF2,#05H;
0265 7900            422             MOV R1,#0;
0267 418F            423             AJMP WAT4RLS3;
0269                 424         C33:
0269 B40411          425             CJNE A,#04H,C34;
026C B90007          426             CJNE R1,#0,C33BUF2;
026F 755402          427             MOV KEYBUF1,#02H;
0272 7901            428             MOV R1,#1;
0274 418F            429             AJMP WAT4RLS3;
0276                 430         C33BUF2:
0276 755302          431             MOV KEYBUF2,#02H;
0279 7900            432             MOV R1,#0;
027B 418F            433             AJMP WAT4RLS3;
027D                 434         C34:
027D B408A2          435             CJNE A,#08H,WAT4RLS2;
0280 B90007          436             CJNE R1,#0,C34BUF2;
0283 755400          437             MOV KEYBUF1,#00H;
0286 7901            438             MOV R1,#1;
0288 418F            439             AJMP WAT4RLS3;
028A                 440         C34BUF2:
028A 755300          441             MOV KEYBUF2,#00H;
028D 7900            442             MOV R1,#0;
                     443     
028F                 444         WAT4RLS3:;WAITE FOR REALSE
028F E5B0            445             MOV A,P3;
0291 540F            446             ANL A,#0FH;
0293 640F            447             XRL A,#0FH;
0295 70F8            448             JNZ WAT4RLS3;
                     449     
0297                 450         KBSCNR4:
A51 MACRO ASSEMBLER  PIRTEST                                                              11/02/2019 10:24:22 PAGE     8

0297 75B0FF          451             MOV P3,#0FFH;
029A C2B7            452             CLR P3.7;
029C E5B0            453             MOV A,P3;
029E 540F            454             ANL A,#0FH;
02A0 640F            455             XRL A,#0FH;
02A2 6052            456             JZ KBSCNEND;
02A4 7152            457             CALL DELAY4KBD;
                     458     
02A6 E5B0            459             MOV A,P3;
02A8 540F            460             ANL A,#0FH;
02AA 640F            461             XRL A,#0FH;
02AC 6048            462             JZ KBSCNEND;
                     463     
02AE                 464         C41:
02AE B40111          465             CJNE A,#01H,C42;0001Â∑¶‰∏äËßíË¢´Êåâ‰∏ã
02B1 B90007          466             CJNE R1,#0,C41BUF2;
02B4 755409          467             MOV KEYBUF1,#09H;
02B7 7901            468             MOV R1,#1;
02B9 41EE            469             AJMP WAT4RLS4;
02BB                 470         C41BUF2:
02BB 755309          471             MOV KEYBUF2,#09H;
02BE 7900            472             MOV R1,#0;
02C0 41EE            473             AJMP WAT4RLS4;
02C2                 474         C42:
02C2 B40211          475             CJNE A,#02H,C43;
02C5 B90007          476             CJNE R1,#0,C42BUF2;
02C8 755406          477             MOV KEYBUF1,#06H;
02CB 7901            478             MOV R1,#1;
02CD 41EE            479             AJMP WAT4RLS4;
02CF                 480         C42BUF2:
02CF 755306          481             MOV KEYBUF2,#06H;
02D2 7900            482             MOV R1,#0;
02D4 41EE            483             AJMP WAT4RLS4;
02D6                 484         C43:
02D6 B40411          485             CJNE A,#04H,C44;
02D9 B90007          486             CJNE R1,#0,C43BUF2;
02DC 755403          487             MOV KEYBUF1,#03H;
02DF 7901            488             MOV R1,#1;
02E1 41EE            489             AJMP WAT4RLS4;
02E3                 490         C43BUF2:
02E3 755303          491             MOV KEYBUF2,#03H;
02E6 7900            492             MOV R1,#0;
02E8 41EE            493             AJMP WAT4RLS4;
02EA                 494         C44:
02EA B40801          495             CJNE A,#08H,WAT4RLS4;
02ED 00              496             NOP;
                     497     
02EE                 498         WAT4RLS4:;WAITE FOR REALSE
02EE E5B0            499             MOV A,P3;
02F0 540F            500             ANL A,#0FH;
02F2 640F            501             XRL A,#0FH;
02F4 70F8            502             JNZ WAT4RLS4;
                     503     
                     504     
                     505     
02F6                 506         KBSCNEND:
                     507     
02F6 C2A6            508             CLR P2.6;
02F8 D2A7            509             SETB P2.7;
02FA 7580FE          510             MOV P0,#0FEH;
02FD 7152            511             CALL DELAY4KBD;
02FF C2A7            512             CLR P2.7;
0301 D2A6            513             SETB P2.6;
0303 900372          514             MOV DPTR,#TIMETAB;
0306 E9              515             MOV A,R1;
0307 600A            516             JZ DISBUF2; 
A51 MACRO ASSEMBLER  PIRTEST                                                              11/02/2019 10:24:22 PAGE     9

0309 E554            517             MOV A,KEYBUF1;
030B 04              518             INC A;
030C 93              519             MOVC A,@A+DPTR;
030D F580            520             MOV P0,A;
030F 7152            521             CALL DELAY4KBD;
0311 611B            522             AJMP DISBUFEND;
0313                 523             DISBUF2:
0313 E553            524                 MOV A,KEYBUF2;
0315 04              525                 INC A;
0316 93              526                 MOVC A,@A+DPTR;
0317 F580            527                 MOV P0,A;
0319 7152            528                 CALL DELAY4KBD;
031B                 529             DISBUFEND:
                     530     
031B 21A5            531             AJMP KBSCNR1;
031D                 532         EXITSET:
031D B297            533             CPL P1.7;
                     534             ;CPL P1.1;
                     535         
031F                 536         WAT4EXIT:;WAITE FOR REALSE
031F E5B0            537             MOV A,P3;
0321 540F            538             ANL A,#0FH;
0323 640F            539             XRL A,#0FH;
0325 70F8            540             JNZ WAT4EXIT;
                     541     
                     542             
                     543     
                     544     
                     545     
                     546     
0327 E554            547             MOV A,KEYBUF1;
0329 75F00A          548             MOV B,#10;
032C A4              549             MUL AB;
032D 2553            550             ADD A,KEYBUF2;
032F F552            551             MOV KEYBUF3,A;
                     552     
0331 C2D3            553             CLR RS0;USE THE DEFAULT SET OF REGISTERS;
0333 D0E0            554             POP ACC;
0335 D0D0            555             POP PSW;
                     556     
0337 855457          557             MOV OFFSET2,KEYBUF1;
                     558             
                     559     
                     560     
                     561     
                     562     
                     563     
033A AC53            564             MOV R4,KEYBUF2;
033C BC0005          565             CJNE R4,#00H,NDINC;
033F 855255          566             MOV DEFAULTDT,KEYBUF3;
0342 6149            567             AJMP NDINCBK;
0344                 568             NDINC:
                     569             ;MOV R5,KEYBUF3;
0344 0557            570             INC OFFSET2;‰∏∫‰ªÄ‰πàË¶ÅÂä†1ÔºåÂõ†‰∏∫Â≠òÊîæÊï∞Á†ÅÁÆ°ÂØπÂ∫î16ËøõÂà∂ÁöÑË°®ÊúÄÂâçÈù¢Â§
                             öÂä†‰∫Ü‰∏Ä‰∏™00H;
0346 855255          571             MOV DEFAULTDT,KEYBUF3;
0349                 572             NDINCBK:
0349 755101          573             MOV ADJUSTFLAG,#1;
                     574             ;SETB IT1;
034C 75B0FF          575             MOV P3,#0FFH;
034F C2B7            576             CLR P3.7;
0351 32              577             RETI;
                     578     
                     579     
0352                 580         DELAY4KBD:
0352 7E0A            581             MOV R6,#10
A51 MACRO ASSEMBLER  PIRTEST                                                              11/02/2019 10:24:22 PAGE    10

0354                 582         D1:        
0354 7FF8            583             MOV R7,#248
0356 DFFE            584             DJNZ R7,$
0358 DEFA            585             DJNZ R6,D1
035A 22              586             RET
                     587     
                     588     
                     589     
                     590     
                     591     
                     592     
                     593     
035B                 594     PWNWAT: ;power on wait
035B C0D0            595             PUSH PSW;
035D C0E0            596             PUSH ACC;
035F D2D3            597             SETB RS0;
0361 7928            598             MOV R1,#40;
0363 7A0A            599             MOV R2,#10;
0365                 600         PW1:
0365 00              601             NOP;
0366 00              602             NOP;
0367 D9FC            603             DJNZ R1,PW1;
0369 7928            604             MOV R1,#40;
036B DAF8            605             DJNZ R2,PW1;
036D D0E0            606             POP ACC;
036F D0D0            607             POP PSW;
0371 22              608             RET;
                     609     
                     610     
0372                 611     TIMETAB:
0372 003F065B        612         DB 00H,3FH,06H,5BH;
0376 4F666D7D        613         DB 4FH,66H,6DH,7DH;
037A 077F6F          614         DB 07H,7FH,6FH;
                     615         ;DB 6FH,7FH,07H,7DH;
                     616         ;DB 6DH,66H,4FH,5BH;
                     617         ;DB 06H,3FH;
                     618     END;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/02/2019 10:24:22 PAGE    11

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

ACC. . . . . . . .  D ADDR   00E0H   A   
ADJUST . . . . . .  C ADDR   00B8H   A   
ADJUST1. . . . . .  C ADDR   00C1H   A   
ADJUSTFLAG . . . .  N NUMB   0051H   A   
ASGTO. . . . . . .  C ADDR   0101H   A   
B. . . . . . . . .  D ADDR   00F0H   A   
BAL1 . . . . . . .  C ADDR   0143H   A   
BAL2 . . . . . . .  C ADDR   015DH   A   
BAL3 . . . . . . .  C ADDR   0177H   A   
BALANCE. . . . . .  N NUMB   0056H   A   
BREAK. . . . . . .  C ADDR   0183H   A   
C11. . . . . . . .  C ADDR   01BCH   A   
C12. . . . . . . .  C ADDR   01BDH   A   
C13. . . . . . . .  C ADDR   01BEH   A   
C14. . . . . . . .  C ADDR   01BFH   A   
C21. . . . . . . .  C ADDR   01DFH   A   
C21BUF2. . . . . .  C ADDR   01EEH   A   
C22. . . . . . . .  C ADDR   01F5H   A   
C22BUF2. . . . . .  C ADDR   0202H   A   
C23. . . . . . . .  C ADDR   0209H   A   
C23BUF2. . . . . .  C ADDR   0216H   A   
C24. . . . . . . .  C ADDR   021DH   A   
C31. . . . . . . .  C ADDR   0241H   A   
C31BUF2. . . . . .  C ADDR   024EH   A   
C32. . . . . . . .  C ADDR   0255H   A   
C32BUF2. . . . . .  C ADDR   0262H   A   
C33. . . . . . . .  C ADDR   0269H   A   
C33BUF2. . . . . .  C ADDR   0276H   A   
C34. . . . . . . .  C ADDR   027DH   A   
C34BUF2. . . . . .  C ADDR   028AH   A   
C41. . . . . . . .  C ADDR   02AEH   A   
C41BUF2. . . . . .  C ADDR   02BBH   A   
C42. . . . . . . .  C ADDR   02C2H   A   
C42BUF2. . . . . .  C ADDR   02CFH   A   
C43. . . . . . . .  C ADDR   02D6H   A   
C43BUF2. . . . . .  C ADDR   02E3H   A   
C44. . . . . . . .  C ADDR   02EAH   A   
CFG. . . . . . . .  C ADDR   00FCH   A   
CMP3 . . . . . . .  C ADDR   009FH   A   
CMP3INT. . . . . .  C ADDR   00DDH   A   
CMP5 . . . . . . .  C ADDR   00A4H   A   
CMP5INT. . . . . .  C ADDR   00E9H   A   
D1 . . . . . . . .  C ADDR   0354H   A   
DEF. . . . . . . .  C ADDR   0000H   A   
DEFAULTDT. . . . .  N NUMB   0055H   A   
DELAY. . . . . . .  C ADDR   012DH   A   
DELAY10MS. . . . .  C ADDR   0117H   A   
DELAY1S. . . . . .  C ADDR   0117H   A   
DELAY4KBD. . . . .  C ADDR   0352H   A   
DISBUF2. . . . . .  C ADDR   0313H   A   
DISBUFEND. . . . .  C ADDR   031BH   A   
EA . . . . . . . .  B ADDR   00A8H.7 A   
ET0. . . . . . . .  B ADDR   00A8H.1 A   
EX1. . . . . . . .  B ADDR   00A8H.2 A   
EXITSET. . . . . .  C ADDR   031DH   A   
IT1. . . . . . . .  B ADDR   0088H.2 A   
KBSCN. . . . . . .  C ADDR   0188H   A   
KBSCNEND . . . . .  C ADDR   02F6H   A   
KBSCNR1. . . . . .  C ADDR   01A5H   A   
KBSCNR2. . . . . .  C ADDR   01C8H   A   
A51 MACRO ASSEMBLER  PIRTEST                                                              11/02/2019 10:24:22 PAGE    12

KBSCNR3. . . . . .  C ADDR   022AH   A   
KBSCNR4. . . . . .  C ADDR   0297H   A   
KEYBUF1. . . . . .  N NUMB   0054H   A   
KEYBUF2. . . . . .  N NUMB   0053H   A   
KEYBUF3. . . . . .  N NUMB   0052H   A   
LIGHT. . . . . . .  C ADDR   00A7H   A   
LIGHTTIME. . . . .  C ADDR   00C5H   A   
LOOP . . . . . . .  C ADDR   007DH   A   
LOOPTAG. . . . . .  N NUMB   0060H   A   
LOOPTIME . . . . .  N NUMB   0059H   A   
MAIN . . . . . . .  C ADDR   0060H   A   
NDINC. . . . . . .  C ADDR   0344H   A   
NDINCBK. . . . . .  C ADDR   0349H   A   
NOINT. . . . . . .  C ADDR   00F5H   A   
NUMDIS . . . . . .  C ADDR   013CH   A   
OFFSET1. . . . . .  N NUMB   0058H   A   
OFFSET2. . . . . .  N NUMB   0057H   A   
P0 . . . . . . . .  D ADDR   0080H   A   
P1 . . . . . . . .  D ADDR   0090H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
P3 . . . . . . . .  D ADDR   00B0H   A   
PSW. . . . . . . .  D ADDR   00D0H   A   
PW1. . . . . . . .  C ADDR   0365H   A   
PWNWAT . . . . . .  C ADDR   035BH   A   
PX1. . . . . . . .  B ADDR   00B8H.2 A   
RS0. . . . . . . .  B ADDR   00D0H.3 A   
SP . . . . . . . .  D ADDR   0081H   A   
TH0. . . . . . . .  D ADDR   008CH   A   
THT. . . . . . . .  N NUMB   00D8H   A   
TIMEOUT. . . . . .  C ADDR   0124H   A   
TIMETAB. . . . . .  C ADDR   0372H   A   
TL0. . . . . . . .  D ADDR   008AH   A   
TLT. . . . . . . .  N NUMB   00F0H   A   
TMOD . . . . . . .  D ADDR   0089H   A   
TR0. . . . . . . .  B ADDR   0088H.4 A   
WAT4EXIT . . . . .  C ADDR   031FH   A   
WAT4RLS. . . . . .  C ADDR   0193H   A   
WAT4RLS1 . . . . .  C ADDR   01C0H   A   
WAT4RLS2 . . . . .  C ADDR   0222H   A   
WAT4RLS3 . . . . .  C ADDR   028FH   A   
WAT4RLS4 . . . . .  C ADDR   02EEH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
