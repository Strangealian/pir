A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 23:54:45 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN pirtest.OBJ
ASSEMBLER INVOKED BY: E:\Program Files\C51\BIN\A51.EXE pirtest.asm SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

0000                   1     DEF:
  0060                 2         LOOPTAG EQU 60H;Ê¨°Êï∞ÁªüËÆ°‰øùÂ≠òÂú∞ÂùÄ
  0059                 3         LOOPTIME EQU 59H;Âª∂Êó∂Âæ™ÁéØÊ¨°Êï∞‰øùÂ≠òÂú∞ÂùÄ
  0058                 4         OFFSET1 EQU 58H;‰∏™‰ΩçÂÅèÁßªÂú∞ÂùÄËÆ∞ÂΩï
  0057                 5         OFFSET2 EQU 57H;ÂçÅ‰ΩçÂÅèÁßªÂú∞ÂùÄËÆ∞ÂΩï
  0056                 6         BALANCE EQU 56H;Ë¥üËΩΩ ÂùáË°°Ê†áËÆ∞
  0055                 7         DEFAULTDT EQU 55H;
  00D8                 8         THT EQU 0D8H;ËÆ°Êï∞Âô®È´òÂ≠óËäÇ
  00F0                 9         TLT EQU 0F0H;ËÆ°Êï∞Âô®‰ΩéÂ≠óËäÇ
                      10     
  0054                11         KEYBUF1 EQU 54H;ÈîÆÁõòËØªÂÖ•Êï∞ÊçÆÂçÅ‰Ωç
  0053                12         KEYBUF2 EQU 53H;ÈîÆÁõòËØªÂÖ•Êï∞ÊçÆ‰∏™‰ΩçÔºõ
  0052                13         KEYBUF3 EQU 52H;
  0051                14         ADJUSTFLAG EQU 51H;
                      15     
0000                  16         ORG 0000H;
0000 0160             17         AJMP MAIN;
000B                  18         ORG 000BH;T0Ê∫¢Âá∫‰∏≠Êñ≠ÂÖ•Âè£Âú∞ÂùÄ
000B 2127             19         AJMP DELAY;
0013                  20         ORG 0013H;
0013 2182             21         AJMP KBSCN;
0060                  22         ORG 0060H;
                      23         ;!!!!JNZÈúÄË¶ÅÊõ¥Êîπ JNZ ÊòØ‰∏∫‰∫ÜÊµãËØï
                      24     
                      25     
0060                  26     MAIN:
0060 758160           27         MOV SP,#60H;
                      28         
0063 75580A           29         MOV OFFSET1,#0AH;
0066 755703           30         MOV OFFSET2,#03H;
0069 75551E           31         MOV DEFAULTDT,#30;
006C 755905           32         MOV LOOPTIME,#05H;
006F 755101           33         MOV ADJUSTFLAG,#1;
0072 755300           34         MOV KEYBUF2,#00H;
0075 D2AF             35         SETB EA;
0077 D2AA             36             SETB EX1;
0079 D28A             37             SETB IT1;
                      38         
007B D2BA             39         SETB PX1;
                      40         
007D                  41         LOOP:
007D 756000           42             MOV LOOPTAG,#00H;
0080 7556FF           43             MOV BALANCE,#0FFH;
0083 755101           44             MOV ADJUSTFLAG,#1;
                      45     
0086 7590FF           46             MOV P1,#0FFH;p1‰∏∫Êï∞ÊçÆËæìÂá∫ÔºåÁÇπ‰∫ÆLEDÁî®
0089 758000           47             MOV P0,#00H;
                      48     
008C 75B00F           49             MOV P3,#0FH;p3‰∏∫ÈîÆÁõòËæìÂÖ•Âè£
008F 75A0FF           50             MOV P2,#0FFH;p2‰Ωú‰∏∫Êï∞ÊçÆËæìÂÖ•Âè£
                      51             ;LCALL DELAY4KBD;ÊØèÁßí100Ê¨°
                      52     
                      53             ;MOV R7,#0AH;
                      54             ;DTCNSPDCNRL:;DETECTION SPEED CONTROL Ê£ÄÊµãÈÄüÂ∫¶ÊéßÂà∂
                      55     
                      56                 
                      57     
0092 E5A0             58             MOV A,P2;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 23:54:45 PAGE     2

0094 5407             59             ANL A,#07H; 0  Êà™Âèñ‰∏â‰ΩçËæìÂÖ•‰ø°Âè∑ÔºåÂè™ÊúâËæìÂÖ•‰ø°Âè∑ÊòØ1Ôºå3Ôºå5ÊâçÁÇπ‰∫Æ
0096 B40102           60             CJNE A,#01H,CMP3;
0099 01A3             61             AJMP LIGHT;
009B                  62             CMP3:
009B B40302           63                 CJNE A,#03H,CMP5;
009E 01A3             64                 AJMP LIGHT;‰∏∫3ÔºåÁõ¥Êé•Ë∑≥ËΩ¨Âà∞LIGHT
00A0                  65             CMP5:
00A0 B405DA           66                 CJNE A,#05H,LOOP;‰∏∫5ÔºåÊâßË°åLIGHTÂê¶ÂàôËøîÂõûÁªßÁª≠ËØªÂèñP2Âè£
                      67     
00A3                  68         LIGHT:
00A3 B290             69             CPL P1.0;
00A5 00               70             NOP;
00A6 00               71             NOP;
00A7 AD55             72             MOV R5,DEFAULTDT;
00A9 AA57             73             MOV R2,OFFSET2;Â≠òÊîæÊï∞Á†ÅÁÆ°ÂçÅ‰ΩçÂØπÂ∫îÂÅèÁßªÂú∞ÂùÄ
00AB E551             74             MOV A,ADJUSTFLAG;
00AD B40004           75             CJNE A,#0,ADJUST;
00B0 AB58             76             MOV R3,OFFSET1;Â≠òÊîæÊï∞Á†ÅÁÆ°‰∏™‰ΩçÂØπÂ∫îÂÅèÁßªÂú∞ÂùÄ
                      77             
00B2 01C1             78             AJMP LIGHTTIME;
00B4                  79             ADJUST:
00B4 E553             80                 MOV A,KEYBUF2;
00B6 B40004           81                 CJNE A,#00H,ADJUST1;
00B9 AB58             82                 MOV R3,OFFSET1;
00BB 01C1             83                 AJMP LIGHTTIME;
00BD                  84                 ADJUST1:
00BD FB               85                 MOV R3,A;
00BE 755100           86                 MOV ADJUSTFLAG,#0;
                      87     
00C1                  88             LIGHTTIME:
00C1 120111           89                 LCALL DELAY1S;Âª∂Êó∂1sÂêéÊï∞Á†ÅÁÆ°ÊòæÁ§∫Áõ∏Â∫îÊï∞Â≠ó
                      90     
                      91     
                      92                 
                      93                 ;MOV P2,#0FFH;p2‰Ωú‰∏∫Êï∞ÊçÆËæìÂÖ•Âè£
00C4 758000           94                 MOV P0,#00H;
00C7 E5A0             95                 MOV A,P2;
00C9 5407             96                 ANL A,#07H; 0  Êà™Âèñ‰∏â‰ΩçËæìÂÖ•‰ø°Âè∑ÔºåÂè™ÊúâËæìÂÖ•‰ø°Âè∑ÊòØ1Ôºå3Ôºå5ÊâçÁÇπ‰
                             ∫Æ
                      97                 ;JZ LIGHT;‰∏∫0Áõ¥Êé•Ë∑≥ËΩ¨Âà∞ÁÇπ‰∫ÆledÔºõ
00CB B40109           98                 CJNE A,#01H,CMP3INT;
00CE C28C             99                 CLR TR0;
00D0 C2A9            100                 CLR ET0;
00D2 755101          101                 MOV ADJUSTFLAG,#1;
00D5 01A3            102                 AJMP LIGHT;
00D7                 103                 CMP3INT:
00D7 B40309          104                     CJNE A,#03H,CMP5INT;
00DA C28C            105                     CLR TR0;
00DC C2A9            106                     CLR ET0;
00DE 755101          107                     MOV ADJUSTFLAG,#1;
00E1 01A3            108                     AJMP LIGHT;‰∏∫2ÔºåÁõ¥Êé•Ë∑≥ËΩ¨Âà∞LIGHT
00E3                 109                 CMP5INT:
00E3 B40509          110                     CJNE A,#05H,NOINT;‰∏∫4ÔºåÊâßË°åLIGHTÂê¶ÂàôËøîÂõûÁªßÁª≠ËØªÂèñP2Âè£
00E6 C28C            111                     CLR TR0;
00E8 C2A9            112                     CLR ET0;
00EA 755101          113                     MOV ADJUSTFLAG,#1;
00ED 01A3            114                     AJMP LIGHT;
                     115                     
                     116     
00EF                 117                 NOINT:
00EF 1B              118                     DEC R3;
00F0 7400            119                     MOV A,#00H;
00F2 B50301          120                     CJNE A,03H,CFG;
00F5 1A              121                     DEC R2;
00F6                 122                 CFG:
00F6 BB0002          123                     CJNE R3,#00H,ASGTO;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 23:54:45 PAGE     3

00F9 AB58            124                     MOV R3,OFFSET1;
00FB                 125                 ASGTO:
00FB DDC4            126                     DJNZ R5,LIGHTTIME;
00FD B290            127                     CPL P1.0;
00FF C2A6            128                     CLR P2.6;
0101 D2A7            129                     SETB P2.7;
0103 758000          130                     MOV P0,#00H;
0106 C2A7            131                     CLR P2.7;
0108 D2A6            132                     SETB P2.6;
010A 758000          133                     MOV P0,#00H;
010D C2A6            134                     CLR P2.6;
010F 017D            135                     AJMP LOOP;
                     136     
                     137     ;Âª∂Êó∂1sÂ≠êÁ®ãÂ∫è
0111                 138     DELAY1S:
                     139             ;PUSH PSW;
                     140             ;PUSH ACC;
                     141             ;AJMP DELAY10MS;
                     142         
                     143     
                     144     
                     145     
                     146     
                     147     
                     148     
                     149     
                     150     
                     151     
                     152     
                     153     
                     154     
                     155     
0111                 156         DELAY10MS:
0111 758901          157             MOV TMOD,#01H;ËÆ°Êï∞Âô®1Â∑•‰Ωú‰∫éÊñπÂºè1
0114 758CD8          158             MOV TH0,#THT;Âä†‰∏ÄËÆ°Êï∞Âô®È´òÂ≠óËäÇ
0117 758AF0          159             MOV TL0,#TLT;Âä†‰∏ÄËÆ°Êï∞Âô®‰ΩéÂ≠óËäÇ
                     160             ;SETB EA;
011A D28C            161             SETB TR0;
011C D2A9            162             SETB ET0;
                     163             
011E                 164         TIMEOUT:  
011E AE60            165             MOV R6,LOOPTAG;
0120 BE64FB          166             CJNE R6,#64H,TIMEOUT;
0123 756000          167             MOV LOOPTAG,#00H;
                     168             ;POP ACC;
                     169             ;POP PSW;
0126 22              170             RET;
                     171     
                     172     
                     173     
                     174     
                     175     ;ËÆ°Êï∞Âô®1Ê∫¢Âá∫‰∏≠Êñ≠Âá∫Âè£
0127                 176     DELAY:
0127 C0D0            177             PUSH PSW;
0129 C0E0            178             PUSH ACC;
012B AE60            179             MOV R6,LOOPTAG;
012D 0E              180             INC R6;
012E 8E60            181             MOV LOOPTAG,R6;
0130 758CD8          182             MOV TH0,#THT;Âä†‰∏ÄËÆ°Êï∞Âô®È´òÂ≠óËäÇ
0133 758AF0          183             MOV TL0,#TLT;Âä†‰∏ÄËÆ°Êï∞Âô®‰ΩéÂ≠óËäÇ
                     184     
                     185             
                     186             ;ÁÇπ‰∫ÆÊï∞Á†ÅÁÆ°
0136                 187         NUMDIS:
                     188         
                     189             
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 23:54:45 PAGE     4

0136 EE              190             MOV A,R6;
0137 5401            191             ANL A,#01H;
0139 F556            192             MOV BALANCE,A;Ë¥üËΩΩÂùáË°°
013B 701A            193             JNZ BAL2;
013D                 194         BAL1:
013D 7CFD            195             MOV R4,#0FDH;R4Â≠òÊîæÊï∞Á†ÅÁÆ°‰ΩçÁΩÆ‰∏™‰Ωç
                     196             
                     197             ;MOV R3,A;
013F C2A6            198             CLR P2.6;‰ΩçÈÄâÈÄâ‰∏≠‰∏™‰Ωç
0141 D2A7            199             SETB P2.7;
                     200             ;MOV P0,#0FFH;
0143 8C80            201             MOV P0,R4;
0145 C2A7            202             CLR P2.7;
                     203     
0147 90036C          204             MOV DPTR,#TIMETAB;
014A EB              205             MOV A,R3;
014B 93              206             MOVC A,@A+DPTR;Êü•Ë°®ÂæóÂà∞Áõ∏Â∫îÊï∞Â≠óÂØπÂ∫îÂÄº
014C D2A6            207             SETB P2.6;
014E 758000          208             MOV P0,#00H;
0151 F580            209             MOV P0,A;
0153 E556            210             MOV A,BALANCE;
0155 701A            211             JNZ BAL3;
                     212             ;LCALL PWNWAT;Âª∂Êó∂1ms
                     213             ;LCALL PWNWAT;
                     214             
0157                 215         BAL2:
0157 7CFE            216             MOV R4,#0FEH;
                     217         
0159 90036C          218             MOV DPTR, #TIMETAB;
015C EA              219             MOV A,R2;
015D 93              220             MOVC A,@A+DPTR;
                     221             ;CALL PWNWAT;
015E C2A6            222             CLR P2.6;
0160 D2A7            223             SETB P2.7;
                     224             ;MOV P0,#0FFH;
0162 8C80            225             MOV P0,R4;
0164 C2A7            226             CLR P2.7;
0166 D2A6            227             SETB P2.6;
0168 758000          228             MOV P0,#00H;
016B F580            229             MOV P0,A;
016D E556            230             MOV A,BALANCE;
016F 70CC            231             JNZ BAL1;
                     232             ;LCALL PWNWAT;
0171                 233         BAL3:
0171 BE6409          234             CJNE R6,#64H,BREAK;
0174 C2A6            235             CLR P2.6;
                     236             
0176 C28C            237             CLR TR0;
0178 C2A9            238             CLR ET0;
                     239             ;CLR EA;
017A 758900          240             MOV TMOD,#00H;
                     241             ;MOV 60H,#00H;
                     242             
017D                 243         BREAK:
017D D0E0            244             POP ACC;
017F D0D0            245             POP PSW;
0181 32              246             RETI;
                     247     
                     248     
                     249     
                     250     
                     251     
                     252     
                     253     
                     254     
                     255     
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 23:54:45 PAGE     5

                     256     
                     257     
                     258     
                     259     
                     260     
                     261     
                     262     
                     263     
                     264     
                     265     
0182                 266     KBSCN:
                     267     
0182 B297            268             CPL P1.7;p1.7‰∏∫ÈîÆÁõò‰∏≠Êñ≠Ê†áÂøóÔºåÁÅØ‰∫ÆËØ¥ÊòéÊ≠£Á°ÆËøõÂÖ•ÈîÆÁõò‰∏≠Êñ≠ÊúçÂä°Á®ãÂ
                             ∫è
                     269             
0184 755403          270             MOV KEYBUF1,#03H;
0187 755300          271             MOV KEYBUF2,#00H;
018A 75551E          272             MOV DEFAULTDT,#30;
                     273             
018D                 274         WAT4RLS:;WAITE FOR REALSE
018D E5B0            275             MOV A,P3;
018F 540F            276             ANL A,#0FH;
0191 640F            277             XRL A,#0FH;
0193 70F8            278             JNZ WAT4RLS;
                     279     
                     280     
                     281             
0195 C0D0            282             PUSH PSW;
0197 C0E0            283             PUSH ACC;
0199 D2D3            284             SETB RS0;USE THE SECOND SET OF REGISTERS;
019B C28A            285             CLR IT1;
019D 7900            286             MOV R1,#0;R1Áî®‰ΩúÊ†áÂøóÔºåÁî®Êù•Ê†áËÆ∞Êï∞ÊçÆÂ∫îËØ•Â≠òÂÖ•Âì™‰∏™buf„ÄÇ
                     287     
                     288         
                     289     
                     290     
                     291     
                     292     
                     293     
                     294     
                     295     
                     296     
                     297         
019F                 298         KBSCNR1:
019F 75B0FF          299             MOV P3,#0FFH;
01A2 C2B4            300             CLR P3.4;
01A4 E5B0            301             MOV A,P3;
01A6 540F            302             ANL A,#0FH;
01A8 640F            303             XRL A,#0FH;
01AA 6016            304             JZ KBSCNR2;
                     305             
01AC 714C            306             CALL DELAY4KBD;
                     307     
01AE E5B0            308             MOV A,P3;
01B0 540F            309             ANL A,#0FH;
01B2 640F            310             XRL A,#0FH;
01B4 600C            311             JZ KBSCNR2;
01B6                 312         C11:
01B6 00              313             NOP;
01B7                 314         C12:
01B7 00              315             NOP;
01B8                 316         C13:
01B8 00              317             NOP;
01B9                 318         C14:
01B9 00              319             NOP;
                     320         
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 23:54:45 PAGE     6

01BA                 321         WAT4RLS1:;WAITE FOR REALSE
01BA E5B0            322             MOV A,P3;
01BC 540F            323             ANL A,#0FH;
01BE 640F            324             XRL A,#0FH;
01C0 70F8            325             JNZ WAT4RLS1;
                     326     
01C2                 327         KBSCNR2:
01C2 75B0FF          328             MOV P3,#0FFH;
01C5 C2B5            329             CLR P3.5;
01C7 E5B0            330             MOV A,P3;
01C9 540F            331             ANL A,#0FH;
01CB 640F            332             XRL A,#0FH;
01CD 6055            333             JZ KBSCNR3;
01CF 714C            334             CALL DELAY4KBD;
                     335     
01D1 E5B0            336             MOV A,P3;
01D3 540F            337             ANL A,#0FH;
01D5 640F            338             XRL A,#0FH;
01D7 604B            339             JZ KBSCNR3;
                     340     
01D9                 341         C21:
01D9 B40113          342             CJNE A,#01H,C22;0001Â∑¶‰∏äËßíË¢´Êåâ‰∏ã
                     343             
                     344     
                     345     
01DC B90009          346             CJNE R1,#0,C21BUF2;
01DF 755407          347             MOV KEYBUF1,#07H;
01E2 B290            348             CPL P1.0;
01E4 7901            349             MOV R1,#1;
01E6 411C            350             AJMP WAT4RLS2;
01E8                 351         C21BUF2:
01E8 755307          352             MOV KEYBUF2,#07H;
01EB 7900            353             MOV R1,#0;
01ED 411C            354             AJMP WAT4RLS2;
01EF                 355         C22:
01EF B40211          356             CJNE A,#02H,C23;
01F2 B90007          357             CJNE R1,#0,C22BUF2;
01F5 755404          358             MOV KEYBUF1,#04H;
01F8 7901            359             MOV R1,#1;
01FA 411C            360             AJMP WAT4RLS2;
01FC                 361         C22BUF2:
01FC 755304          362             MOV KEYBUF2,#04H;
01FF 7900            363             MOV R1,#0;
0201 411C            364             AJMP WAT4RLS2;
0203                 365         C23:
0203 B40411          366             CJNE A,#04H,C24;
0206 B90007          367             CJNE R1,#0,C23BUF2;
0209 755401          368             MOV KEYBUF1,#01H;
020C 7901            369             MOV R1,#1;
020E 411C            370             AJMP WAT4RLS2;
0210                 371         C23BUF2:
0210 755301          372             MOV KEYBUF2,#01H;
0213 7900            373             MOV R1,#0;
0215 411C            374             AJMP WAT4RLS2;
0217                 375         C24:
0217 B40802          376             CJNE A,#08H,WAT4RLS2;
                     377             ;MOV KEYBUF1,#0FFH;
021A 6117            378             AJMP EXITSET;
                     379     
021C                 380         WAT4RLS2:;WAITE FOR REALSE
021C E5B0            381             MOV A,P3;
021E 540F            382             ANL A,#0FH;
0220 640F            383             XRL A,#0FH;
0222 70F8            384             JNZ WAT4RLS2;
                     385     
                     386     
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 23:54:45 PAGE     7

                     387     
                     388     
0224                 389         KBSCNR3:
0224 75B0FF          390             MOV P3,#0FFH;
0227 C2B6            391             CLR P3.6;
0229 E5B0            392             MOV A,P3;
022B 540F            393             ANL A,#0FH;
022D 640F            394             XRL A,#0FH;
022F 6060            395             JZ KBSCNR4;
0231 714C            396             CALL DELAY4KBD;
                     397     
0233 E5B0            398             MOV A,P3;
0235 540F            399             ANL A,#0FH;
0237 640F            400             XRL A,#0FH;
0239 6056            401             JZ KBSCNR4;
                     402     
023B                 403         C31:
023B B40111          404             CJNE A,#01H,C32;0001Â∑¶‰∏äËßíË¢´Êåâ‰∏ã
023E B90007          405             CJNE R1,#0,C31BUF2;
0241 755408          406             MOV KEYBUF1,#08H;
0244 7901            407             MOV R1,#1;
0246 4189            408             AJMP WAT4RLS3;
0248                 409         C31BUF2:
0248 755308          410             MOV KEYBUF2,#08H;
024B 7900            411             MOV R1,#0;
024D 4189            412             AJMP WAT4RLS3;
024F                 413         C32:
024F B40211          414             CJNE A,#02H,C33;
0252 B90007          415             CJNE R1,#0,C32BUF2;
0255 755405          416             MOV KEYBUF1,#05H;
0258 7901            417             MOV R1,#1;
025A 4189            418             AJMP WAT4RLS3;
025C                 419         C32BUF2:
025C 755305          420             MOV KEYBUF2,#05H;
025F 7900            421             MOV R1,#0;
0261 4189            422             AJMP WAT4RLS3;
0263                 423         C33:
0263 B40411          424             CJNE A,#04H,C34;
0266 B90007          425             CJNE R1,#0,C33BUF2;
0269 755402          426             MOV KEYBUF1,#02H;
026C 7901            427             MOV R1,#1;
026E 4189            428             AJMP WAT4RLS3;
0270                 429         C33BUF2:
0270 755302          430             MOV KEYBUF2,#02H;
0273 7900            431             MOV R1,#0;
0275 4189            432             AJMP WAT4RLS3;
0277                 433         C34:
0277 B408A2          434             CJNE A,#08H,WAT4RLS2;
027A B90007          435             CJNE R1,#0,C34BUF2;
027D 755400          436             MOV KEYBUF1,#00H;
0280 7901            437             MOV R1,#1;
0282 4189            438             AJMP WAT4RLS3;
0284                 439         C34BUF2:
0284 755300          440             MOV KEYBUF2,#00H;
0287 7900            441             MOV R1,#0;
                     442     
0289                 443         WAT4RLS3:;WAITE FOR REALSE
0289 E5B0            444             MOV A,P3;
028B 540F            445             ANL A,#0FH;
028D 640F            446             XRL A,#0FH;
028F 70F8            447             JNZ WAT4RLS3;
                     448     
0291                 449         KBSCNR4:
0291 75B0FF          450             MOV P3,#0FFH;
0294 C2B7            451             CLR P3.7;
0296 E5B0            452             MOV A,P3;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 23:54:45 PAGE     8

0298 540F            453             ANL A,#0FH;
029A 640F            454             XRL A,#0FH;
029C 6052            455             JZ KBSCNEND;
029E 714C            456             CALL DELAY4KBD;
                     457     
02A0 E5B0            458             MOV A,P3;
02A2 540F            459             ANL A,#0FH;
02A4 640F            460             XRL A,#0FH;
02A6 6048            461             JZ KBSCNEND;
                     462     
02A8                 463         C41:
02A8 B40111          464             CJNE A,#01H,C42;0001Â∑¶‰∏äËßíË¢´Êåâ‰∏ã
02AB B90007          465             CJNE R1,#0,C41BUF2;
02AE 755409          466             MOV KEYBUF1,#09H;
02B1 7901            467             MOV R1,#1;
02B3 41E8            468             AJMP WAT4RLS4;
02B5                 469         C41BUF2:
02B5 755309          470             MOV KEYBUF2,#09H;
02B8 7900            471             MOV R1,#0;
02BA 41E8            472             AJMP WAT4RLS4;
02BC                 473         C42:
02BC B40211          474             CJNE A,#02H,C43;
02BF B90007          475             CJNE R1,#0,C42BUF2;
02C2 755406          476             MOV KEYBUF1,#06H;
02C5 7901            477             MOV R1,#1;
02C7 41E8            478             AJMP WAT4RLS4;
02C9                 479         C42BUF2:
02C9 755306          480             MOV KEYBUF2,#06H;
02CC 7900            481             MOV R1,#0;
02CE 41E8            482             AJMP WAT4RLS4;
02D0                 483         C43:
02D0 B40411          484             CJNE A,#04H,C44;
02D3 B90007          485             CJNE R1,#0,C43BUF2;
02D6 755403          486             MOV KEYBUF1,#03H;
02D9 7901            487             MOV R1,#1;
02DB 41E8            488             AJMP WAT4RLS4;
02DD                 489         C43BUF2:
02DD 755303          490             MOV KEYBUF2,#03H;
02E0 7900            491             MOV R1,#0;
02E2 41E8            492             AJMP WAT4RLS4;
02E4                 493         C44:
02E4 B40801          494             CJNE A,#08H,WAT4RLS4;
02E7 00              495             NOP;
                     496     
02E8                 497         WAT4RLS4:;WAITE FOR REALSE
02E8 E5B0            498             MOV A,P3;
02EA 540F            499             ANL A,#0FH;
02EC 640F            500             XRL A,#0FH;
02EE 70F8            501             JNZ WAT4RLS4;
                     502     
                     503     
                     504     
02F0                 505         KBSCNEND:
                     506     
02F0 C2A6            507             CLR P2.6;
02F2 D2A7            508             SETB P2.7;
02F4 7580FE          509             MOV P0,#0FEH;
02F7 714C            510             CALL DELAY4KBD;
02F9 C2A7            511             CLR P2.7;
02FB D2A6            512             SETB P2.6;
02FD 90036C          513             MOV DPTR,#TIMETAB;
0300 E9              514             MOV A,R1;
0301 600A            515             JZ DISBUF2; 
0303 E554            516             MOV A,KEYBUF1;
0305 04              517             INC A;
0306 93              518             MOVC A,@A+DPTR;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 23:54:45 PAGE     9

0307 F580            519             MOV P0,A;
0309 714C            520             CALL DELAY4KBD;
030B 6115            521             AJMP DISBUFEND;
030D                 522             DISBUF2:
030D E553            523                 MOV A,KEYBUF2;
030F 04              524                 INC A;
0310 93              525                 MOVC A,@A+DPTR;
0311 F580            526                 MOV P0,A;
0313 714C            527                 CALL DELAY4KBD;
0315                 528             DISBUFEND:
                     529     
0315 219F            530             AJMP KBSCNR1;
0317                 531         EXITSET:
0317 B297            532             CPL P1.7;
                     533             ;CPL P1.1;
                     534         
0319                 535         WAT4EXIT:;WAITE FOR REALSE
0319 E5B0            536             MOV A,P3;
031B 540F            537             ANL A,#0FH;
031D 640F            538             XRL A,#0FH;
031F 70F8            539             JNZ WAT4EXIT;
                     540     
                     541             
                     542     
                     543     
                     544     
                     545     
0321 E554            546             MOV A,KEYBUF1;
0323 75F00A          547             MOV B,#10;
0326 A4              548             MUL AB;
0327 2553            549             ADD A,KEYBUF2;
0329 F552            550             MOV KEYBUF3,A;
                     551     
032B C2D3            552             CLR RS0;USE THE DEFAULT SET OF REGISTERS;
032D D0E0            553             POP ACC;
032F D0D0            554             POP PSW;
                     555     
0331 855457          556             MOV OFFSET2,KEYBUF1;
                     557             
                     558     
                     559     
                     560     
                     561     
                     562     
0334 AC53            563             MOV R4,KEYBUF2;
0336 BC0005          564             CJNE R4,#00H,NDINC;
0339 855255          565             MOV DEFAULTDT,KEYBUF3;
033C 6143            566             AJMP NDINCBK;
033E                 567             NDINC:
                     568             ;MOV R5,KEYBUF3;
033E 0557            569             INC OFFSET2;‰∏∫‰ªÄ‰πàË¶ÅÂä†1ÔºåÂõ†‰∏∫Â≠òÊîæÊï∞Á†ÅÁÆ°ÂØπÂ∫î16ËøõÂà∂ÁöÑË°®ÊúÄÂâçÈù¢Â§
                             öÂä†‰∫Ü‰∏Ä‰∏™00H;
0340 855255          570             MOV DEFAULTDT,KEYBUF3;
0343                 571             NDINCBK:
0343 755101          572             MOV ADJUSTFLAG,#1;
0346 D28A            573             SETB IT1;
0348 75B00F          574             MOV P3,#0FH;
034B 32              575             RETI;
                     576     
                     577     
034C                 578         DELAY4KBD:
034C 7E0A            579             MOV R6,#10
034E                 580         D1:        
034E 7FF8            581             MOV R7,#248
0350 DFFE            582             DJNZ R7,$
0352 DEFA            583             DJNZ R6,D1
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 23:54:45 PAGE    10

0354 22              584             RET
                     585     
                     586     
                     587     
                     588     
                     589     
                     590     
                     591     
0355                 592     PWNWAT: ;power on wait
0355 C0D0            593             PUSH PSW;
0357 C0E0            594             PUSH ACC;
0359 D2D3            595             SETB RS0;
035B 7928            596             MOV R1,#40;
035D 7A0A            597             MOV R2,#10;
035F                 598         PW1:
035F 00              599             NOP;
0360 00              600             NOP;
0361 D9FC            601             DJNZ R1,PW1;
0363 7928            602             MOV R1,#40;
0365 DAF8            603             DJNZ R2,PW1;
0367 D0E0            604             POP ACC;
0369 D0D0            605             POP PSW;
036B 22              606             RET;
                     607     
                     608     
036C                 609     TIMETAB:
036C 003F065B        610         DB 00H,3FH,06H,5BH;
0370 4F666D7D        611         DB 4FH,66H,6DH,7DH;
0374 077F6F          612         DB 07H,7FH,6FH;
                     613         ;DB 6FH,7FH,07H,7DH;
                     614         ;DB 6DH,66H,4FH,5BH;
                     615         ;DB 06H,3FH;
                     616     END;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 23:54:45 PAGE    11

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

ACC. . . . . . . .  D ADDR   00E0H   A   
ADJUST . . . . . .  C ADDR   00B4H   A   
ADJUST1. . . . . .  C ADDR   00BDH   A   
ADJUSTFLAG . . . .  N NUMB   0051H   A   
ASGTO. . . . . . .  C ADDR   00FBH   A   
B. . . . . . . . .  D ADDR   00F0H   A   
BAL1 . . . . . . .  C ADDR   013DH   A   
BAL2 . . . . . . .  C ADDR   0157H   A   
BAL3 . . . . . . .  C ADDR   0171H   A   
BALANCE. . . . . .  N NUMB   0056H   A   
BREAK. . . . . . .  C ADDR   017DH   A   
C11. . . . . . . .  C ADDR   01B6H   A   
C12. . . . . . . .  C ADDR   01B7H   A   
C13. . . . . . . .  C ADDR   01B8H   A   
C14. . . . . . . .  C ADDR   01B9H   A   
C21. . . . . . . .  C ADDR   01D9H   A   
C21BUF2. . . . . .  C ADDR   01E8H   A   
C22. . . . . . . .  C ADDR   01EFH   A   
C22BUF2. . . . . .  C ADDR   01FCH   A   
C23. . . . . . . .  C ADDR   0203H   A   
C23BUF2. . . . . .  C ADDR   0210H   A   
C24. . . . . . . .  C ADDR   0217H   A   
C31. . . . . . . .  C ADDR   023BH   A   
C31BUF2. . . . . .  C ADDR   0248H   A   
C32. . . . . . . .  C ADDR   024FH   A   
C32BUF2. . . . . .  C ADDR   025CH   A   
C33. . . . . . . .  C ADDR   0263H   A   
C33BUF2. . . . . .  C ADDR   0270H   A   
C34. . . . . . . .  C ADDR   0277H   A   
C34BUF2. . . . . .  C ADDR   0284H   A   
C41. . . . . . . .  C ADDR   02A8H   A   
C41BUF2. . . . . .  C ADDR   02B5H   A   
C42. . . . . . . .  C ADDR   02BCH   A   
C42BUF2. . . . . .  C ADDR   02C9H   A   
C43. . . . . . . .  C ADDR   02D0H   A   
C43BUF2. . . . . .  C ADDR   02DDH   A   
C44. . . . . . . .  C ADDR   02E4H   A   
CFG. . . . . . . .  C ADDR   00F6H   A   
CMP3 . . . . . . .  C ADDR   009BH   A   
CMP3INT. . . . . .  C ADDR   00D7H   A   
CMP5 . . . . . . .  C ADDR   00A0H   A   
CMP5INT. . . . . .  C ADDR   00E3H   A   
D1 . . . . . . . .  C ADDR   034EH   A   
DEF. . . . . . . .  C ADDR   0000H   A   
DEFAULTDT. . . . .  N NUMB   0055H   A   
DELAY. . . . . . .  C ADDR   0127H   A   
DELAY10MS. . . . .  C ADDR   0111H   A   
DELAY1S. . . . . .  C ADDR   0111H   A   
DELAY4KBD. . . . .  C ADDR   034CH   A   
DISBUF2. . . . . .  C ADDR   030DH   A   
DISBUFEND. . . . .  C ADDR   0315H   A   
EA . . . . . . . .  B ADDR   00A8H.7 A   
ET0. . . . . . . .  B ADDR   00A8H.1 A   
EX1. . . . . . . .  B ADDR   00A8H.2 A   
EXITSET. . . . . .  C ADDR   0317H   A   
IT1. . . . . . . .  B ADDR   0088H.2 A   
KBSCN. . . . . . .  C ADDR   0182H   A   
KBSCNEND . . . . .  C ADDR   02F0H   A   
KBSCNR1. . . . . .  C ADDR   019FH   A   
KBSCNR2. . . . . .  C ADDR   01C2H   A   
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 23:54:45 PAGE    12

KBSCNR3. . . . . .  C ADDR   0224H   A   
KBSCNR4. . . . . .  C ADDR   0291H   A   
KEYBUF1. . . . . .  N NUMB   0054H   A   
KEYBUF2. . . . . .  N NUMB   0053H   A   
KEYBUF3. . . . . .  N NUMB   0052H   A   
LIGHT. . . . . . .  C ADDR   00A3H   A   
LIGHTTIME. . . . .  C ADDR   00C1H   A   
LOOP . . . . . . .  C ADDR   007DH   A   
LOOPTAG. . . . . .  N NUMB   0060H   A   
LOOPTIME . . . . .  N NUMB   0059H   A   
MAIN . . . . . . .  C ADDR   0060H   A   
NDINC. . . . . . .  C ADDR   033EH   A   
NDINCBK. . . . . .  C ADDR   0343H   A   
NOINT. . . . . . .  C ADDR   00EFH   A   
NUMDIS . . . . . .  C ADDR   0136H   A   
OFFSET1. . . . . .  N NUMB   0058H   A   
OFFSET2. . . . . .  N NUMB   0057H   A   
P0 . . . . . . . .  D ADDR   0080H   A   
P1 . . . . . . . .  D ADDR   0090H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
P3 . . . . . . . .  D ADDR   00B0H   A   
PSW. . . . . . . .  D ADDR   00D0H   A   
PW1. . . . . . . .  C ADDR   035FH   A   
PWNWAT . . . . . .  C ADDR   0355H   A   
PX1. . . . . . . .  B ADDR   00B8H.2 A   
RS0. . . . . . . .  B ADDR   00D0H.3 A   
SP . . . . . . . .  D ADDR   0081H   A   
TH0. . . . . . . .  D ADDR   008CH   A   
THT. . . . . . . .  N NUMB   00D8H   A   
TIMEOUT. . . . . .  C ADDR   011EH   A   
TIMETAB. . . . . .  C ADDR   036CH   A   
TL0. . . . . . . .  D ADDR   008AH   A   
TLT. . . . . . . .  N NUMB   00F0H   A   
TMOD . . . . . . .  D ADDR   0089H   A   
TR0. . . . . . . .  B ADDR   0088H.4 A   
WAT4EXIT . . . . .  C ADDR   0319H   A   
WAT4RLS. . . . . .  C ADDR   018DH   A   
WAT4RLS1 . . . . .  C ADDR   01BAH   A   
WAT4RLS2 . . . . .  C ADDR   021CH   A   
WAT4RLS3 . . . . .  C ADDR   0289H   A   
WAT4RLS4 . . . . .  C ADDR   02E8H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
