A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 20:22:00 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN pirtest.OBJ
ASSEMBLER INVOKED BY: E:\Program Files\C51\BIN\A51.EXE pirtest.asm SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

0000                   1     DEF:
  0060                 2         LOOPTAG EQU 60H;Ê¨°Êï∞ÁªüËÆ°‰øùÂ≠òÂú∞ÂùÄ
  0059                 3         LOOPTIME EQU 59H;Âª∂Êó∂Âæ™ÁéØÊ¨°Êï∞‰øùÂ≠òÂú∞ÂùÄ
  0058                 4         OFFSET1 EQU 58H;‰∏™‰ΩçÂÅèÁßªÂú∞ÂùÄËÆ∞ÂΩï
  0057                 5         OFFSET2 EQU 57H;ÂçÅ‰ΩçÂÅèÁßªÂú∞ÂùÄËÆ∞ÂΩï
  0056                 6         BALANCE EQU 56H;Ë¥üËΩΩ ÂùáË°°Ê†áËÆ∞
  0055                 7         DEFAULTDT EQU 55H;
  00D8                 8         THT EQU 0D8H;ËÆ°Êï∞Âô®È´òÂ≠óËäÇ
  00F0                 9         TLT EQU 0F0H;ËÆ°Êï∞Âô®‰ΩéÂ≠óËäÇ
                      10     
  0054                11         KEYBUF1 EQU 54H;ÈîÆÁõòËØªÂÖ•Êï∞ÊçÆÂçÅ‰Ωç
  0053                12         KEYBUF2 EQU 53H;ÈîÆÁõòËØªÂÖ•Êï∞ÊçÆ‰∏™‰ΩçÔºõ
  0052                13         KEYBUF3 EQU 52H;
  0051                14         ADJUSTFLAG EQU 51H;
                      15     
0000                  16         ORG 0000H;
0000 0160             17         AJMP MAIN;
000B                  18         ORG 000BH;T0Ê∫¢Âá∫‰∏≠Êñ≠ÂÖ•Âè£Âú∞ÂùÄ
000B 211E             19         AJMP DELAY;
0013                  20         ORG 0013H;
0013 2179             21         AJMP KBSCN;
0060                  22         ORG 0060H;
                      23         ;!!!!JNZÈúÄË¶ÅÊõ¥Êîπ JNZ ÊòØ‰∏∫‰∫ÜÊµãËØï
                      24     
                      25     
0060                  26     MAIN:
0060 758160           27         MOV SP,#60H;
                      28         
0063 75580A           29         MOV OFFSET1,#0AH;
0066 755703           30         MOV OFFSET2,#03H;
0069 75551E           31         MOV DEFAULTDT,#30;
006C 755905           32         MOV LOOPTIME,#05H;
006F 755101           33         MOV ADJUSTFLAG,#1;
0072 755300           34         MOV KEYBUF2,#00H;
0075 D2AF             35         SETB EA;
0077 D2AA             36             SETB EX1;
0079 D28A             37             SETB IT1;
                      38         
007B D2BA             39         SETB PX1;
                      40         
007D                  41         LOOP:
007D 756000           42             MOV LOOPTAG,#00H;
0080 7556FF           43             MOV BALANCE,#0FFH;
0083 755101           44             MOV ADJUSTFLAG,#1;
                      45     
0086 7590FF           46             MOV P1,#0FFH;p1‰∏∫Êï∞ÊçÆËæìÂá∫ÔºåÁÇπ‰∫ÆLEDÁî®
0089 758000           47             MOV P0,#00H;
                      48     
008C 75B00F           49             MOV P3,#0FH;p3‰∏∫ÈîÆÁõòËæìÂÖ•Âè£
008F 75A0FF           50             MOV P2,#0FFH;p2‰Ωú‰∏∫Êï∞ÊçÆËæìÂÖ•Âè£
                      51             ;LCALL DELAY4KBD;ÊØèÁßí100Ê¨°
                      52     
                      53             ;MOV R7,#0AH;
                      54             ;DTCNSPDCNRL:;DETECTION SPEED CONTROL Ê£ÄÊµãÈÄüÂ∫¶ÊéßÂà∂
                      55     
                      56                 
                      57     
0092 E5A0             58             MOV A,P2;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 20:22:00 PAGE     2

0094 5407             59             ANL A,#07H; 0  Êà™Âèñ‰∏â‰ΩçËæìÂÖ•‰ø°Âè∑ÔºåÂè™ÊúâËæìÂÖ•‰ø°Âè∑ÊòØ1Ôºå3Ôºå5ÊâçÁÇπ‰∫Æ
0096 B40102           60             CJNE A,#01H,CMP3;
0099 01A3             61             AJMP LIGHT;
009B                  62             CMP3:
009B B40302           63                 CJNE A,#03H,CMP5;
009E 01A3             64                 AJMP LIGHT;‰∏∫3ÔºåÁõ¥Êé•Ë∑≥ËΩ¨Âà∞LIGHT
00A0                  65             CMP5:
00A0 B405DA           66                 CJNE A,#05H,LOOP;‰∏∫5ÔºåÊâßË°åLIGHTÂê¶ÂàôËøîÂõûÁªßÁª≠ËØªÂèñP2Âè£
                      67     
00A3                  68         LIGHT:
00A3 B290             69             CPL P1.0;
00A5 00               70             NOP;
00A6 00               71             NOP;
00A7 AD55             72             MOV R5,DEFAULTDT;
00A9 AA57             73             MOV R2,OFFSET2;Â≠òÊîæÊï∞Á†ÅÁÆ°ÂçÅ‰ΩçÂØπÂ∫îÂÅèÁßªÂú∞ÂùÄ
00AB E551             74             MOV A,ADJUSTFLAG;
00AD B40004           75             CJNE A,#0,ADJUST;
00B0 AB58             76             MOV R3,OFFSET1;Â≠òÊîæÊï∞Á†ÅÁÆ°‰∏™‰ΩçÂØπÂ∫îÂÅèÁßªÂú∞ÂùÄ
                      77             
00B2 01C1             78             AJMP LIGHTTIME;
00B4                  79             ADJUST:
00B4 E553             80                 MOV A,KEYBUF2;
00B6 B40004           81                 CJNE A,#00H,ADJUST1;
00B9 AB58             82                 MOV R3,OFFSET1;
00BB 01C1             83                 AJMP LIGHTTIME;
00BD                  84                 ADJUST1:
00BD FB               85                 MOV R3,A;
00BE 755100           86                 MOV ADJUSTFLAG,#0;
                      87     
00C1                  88             LIGHTTIME:
00C1 120108           89                 LCALL DELAY1S;Âª∂Êó∂1sÂêéÊï∞Á†ÅÁÆ°ÊòæÁ§∫Áõ∏Â∫îÊï∞Â≠ó
                      90     
                      91     
                      92                 
                      93                 ;MOV P2,#0FFH;p2‰Ωú‰∏∫Êï∞ÊçÆËæìÂÖ•Âè£
00C4 758000           94                 MOV P0,#00H;
00C7 E5A0             95                 MOV A,P2;
00C9 5407             96                 ANL A,#07H; 0  Êà™Âèñ‰∏â‰ΩçËæìÂÖ•‰ø°Âè∑ÔºåÂè™ÊúâËæìÂÖ•‰ø°Âè∑ÊòØ1Ôºå3Ôºå5ÊâçÁÇπ‰
                             ∫Æ
                      97                 ;JZ LIGHT;‰∏∫0Áõ¥Êé•Ë∑≥ËΩ¨Âà∞ÁÇπ‰∫ÆledÔºõ
00CB B40106           98                 CJNE A,#01H,CMP3INT;
00CE C28C             99                 CLR TR0;
00D0 C2A9            100                 CLR ET0;
00D2 01A3            101                 AJMP LIGHT;
00D4                 102                 CMP3INT:
00D4 B40306          103                     CJNE A,#03H,CMP5INT;
00D7 C28C            104                     CLR TR0;
00D9 C2A9            105                     CLR ET0;
00DB 01A3            106                     AJMP LIGHT;‰∏∫2ÔºåÁõ¥Êé•Ë∑≥ËΩ¨Âà∞LIGHT
00DD                 107                 CMP5INT:
00DD B40506          108                     CJNE A,#05H,NOINT;‰∏∫4ÔºåÊâßË°åLIGHTÂê¶ÂàôËøîÂõûÁªßÁª≠ËØªÂèñP2Âè£
00E0 C28C            109                     CLR TR0;
00E2 C2A9            110                     CLR ET0;
00E4 01A3            111                     AJMP LIGHT;
                     112                     
                     113     
00E6                 114                 NOINT:
00E6 1B              115                     DEC R3;
00E7 7400            116                     MOV A,#00H;
00E9 B50301          117                     CJNE A,03H,CFG;
00EC 1A              118                     DEC R2;
00ED                 119                 CFG:
00ED BB0002          120                     CJNE R3,#00H,ASGTO;
00F0 AB58            121                     MOV R3,OFFSET1;
00F2                 122                 ASGTO:
00F2 DDCD            123                     DJNZ R5,LIGHTTIME;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 20:22:00 PAGE     3

00F4 B290            124                     CPL P1.0;
00F6 C2A6            125                     CLR P2.6;
00F8 D2A7            126                     SETB P2.7;
00FA 758000          127                     MOV P0,#00H;
00FD C2A7            128                     CLR P2.7;
00FF D2A6            129                     SETB P2.6;
0101 758000          130                     MOV P0,#00H;
0104 C2A6            131                     CLR P2.6;
0106 017D            132                     AJMP LOOP;
                     133     
                     134     ;Âª∂Êó∂1sÂ≠êÁ®ãÂ∫è
0108                 135     DELAY1S:
                     136             ;PUSH PSW;
                     137             ;PUSH ACC;
                     138             ;AJMP DELAY10MS;
                     139         
                     140     
                     141     
                     142     
                     143     
                     144     
                     145     
                     146     
                     147     
                     148     
                     149     
                     150     
                     151     
                     152     
0108                 153         DELAY10MS:
0108 758901          154             MOV TMOD,#01H;ËÆ°Êï∞Âô®1Â∑•‰Ωú‰∫éÊñπÂºè1
010B 758CD8          155             MOV TH0,#THT;Âä†‰∏ÄËÆ°Êï∞Âô®È´òÂ≠óËäÇ
010E 758AF0          156             MOV TL0,#TLT;Âä†‰∏ÄËÆ°Êï∞Âô®‰ΩéÂ≠óËäÇ
                     157             ;SETB EA;
0111 D28C            158             SETB TR0;
0113 D2A9            159             SETB ET0;
                     160             
0115                 161         TIMEOUT:  
0115 AE60            162             MOV R6,LOOPTAG;
0117 BE64FB          163             CJNE R6,#64H,TIMEOUT;
011A 756000          164             MOV LOOPTAG,#00H;
                     165             ;POP ACC;
                     166             ;POP PSW;
011D 22              167             RET;
                     168     
                     169     
                     170     
                     171     
                     172     ;ËÆ°Êï∞Âô®1Ê∫¢Âá∫‰∏≠Êñ≠Âá∫Âè£
011E                 173     DELAY:
011E C0D0            174             PUSH PSW;
0120 C0E0            175             PUSH ACC;
0122 AE60            176             MOV R6,LOOPTAG;
0124 0E              177             INC R6;
0125 8E60            178             MOV LOOPTAG,R6;
0127 758CD8          179             MOV TH0,#THT;Âä†‰∏ÄËÆ°Êï∞Âô®È´òÂ≠óËäÇ
012A 758AF0          180             MOV TL0,#TLT;Âä†‰∏ÄËÆ°Êï∞Âô®‰ΩéÂ≠óËäÇ
                     181     
                     182             
                     183             ;ÁÇπ‰∫ÆÊï∞Á†ÅÁÆ°
012D                 184         NUMDIS:
                     185         
                     186             
012D EE              187             MOV A,R6;
012E 5401            188             ANL A,#01H;
0130 F556            189             MOV BALANCE,A;Ë¥üËΩΩÂùáË°°
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 20:22:00 PAGE     4

0132 701A            190             JNZ BAL2;
0134                 191         BAL1:
0134 7CFD            192             MOV R4,#0FDH;R4Â≠òÊîæÊï∞Á†ÅÁÆ°‰ΩçÁΩÆ‰∏™‰Ωç
                     193             
                     194             ;MOV R3,A;
0136 C2A6            195             CLR P2.6;‰ΩçÈÄâÈÄâ‰∏≠‰∏™‰Ωç
0138 D2A7            196             SETB P2.7;
                     197             ;MOV P0,#0FFH;
013A 8C80            198             MOV P0,R4;
013C C2A7            199             CLR P2.7;
                     200     
013E 900360          201             MOV DPTR,#TIMETAB;
0141 EB              202             MOV A,R3;
0142 93              203             MOVC A,@A+DPTR;Êü•Ë°®ÂæóÂà∞Áõ∏Â∫îÊï∞Â≠óÂØπÂ∫îÂÄº
0143 D2A6            204             SETB P2.6;
0145 758000          205             MOV P0,#00H;
0148 F580            206             MOV P0,A;
014A E556            207             MOV A,BALANCE;
014C 701A            208             JNZ BAL3;
                     209             ;LCALL PWNWAT;Âª∂Êó∂1ms
                     210             ;LCALL PWNWAT;
                     211             
014E                 212         BAL2:
014E 7CFE            213             MOV R4,#0FEH;
                     214         
0150 900360          215             MOV DPTR, #TIMETAB;
0153 EA              216             MOV A,R2;
0154 93              217             MOVC A,@A+DPTR;
                     218             ;CALL PWNWAT;
0155 C2A6            219             CLR P2.6;
0157 D2A7            220             SETB P2.7;
                     221             ;MOV P0,#0FFH;
0159 8C80            222             MOV P0,R4;
015B C2A7            223             CLR P2.7;
015D D2A6            224             SETB P2.6;
015F 758000          225             MOV P0,#00H;
0162 F580            226             MOV P0,A;
0164 E556            227             MOV A,BALANCE;
0166 70CC            228             JNZ BAL1;
                     229             ;LCALL PWNWAT;
0168                 230         BAL3:
0168 BE6409          231             CJNE R6,#64H,BREAK;
016B C2A6            232             CLR P2.6;
                     233             
016D C28C            234             CLR TR0;
016F C2A9            235             CLR ET0;
                     236             ;CLR EA;
0171 758900          237             MOV TMOD,#00H;
                     238             ;MOV 60H,#00H;
                     239             
0174                 240         BREAK:
0174 D0E0            241             POP ACC;
0176 D0D0            242             POP PSW;
0178 32              243             RETI;
                     244     
                     245     
                     246     
                     247     
                     248     
                     249     
                     250     
                     251     
                     252     
                     253     
                     254     
                     255     
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 20:22:00 PAGE     5

                     256     
                     257     
                     258     
                     259     
                     260     
                     261     
                     262     
0179                 263     KBSCN:
                     264     
0179 B297            265             CPL P1.7;p1.7‰∏∫ÈîÆÁõò‰∏≠Êñ≠Ê†áÂøóÔºåÁÅØ‰∫ÆËØ¥ÊòéÊ≠£Á°ÆËøõÂÖ•ÈîÆÁõò‰∏≠Êñ≠ÊúçÂä°Á®ãÂ
                             ∫è
                     266             
017B 755403          267             MOV KEYBUF1,#03H;
017E 755300          268             MOV KEYBUF2,#00H;
0181 75551E          269             MOV DEFAULTDT,#30;
                     270             
0184                 271         WAT4RLS:;WAITE FOR REALSE
0184 E5B0            272             MOV A,P3;
0186 540F            273             ANL A,#0FH;
0188 640F            274             XRL A,#0FH;
018A 70F8            275             JNZ WAT4RLS;
                     276     
                     277     
                     278             
018C C0D0            279             PUSH PSW;
018E C0E0            280             PUSH ACC;
0190 D2D3            281             SETB RS0;USE THE SECOND SET OF REGISTERS;
0192 C28A            282             CLR IT1;
0194 7900            283             MOV R1,#0;R1Áî®‰ΩúÊ†áÂøóÔºåÁî®Êù•Ê†áËÆ∞Êï∞ÊçÆÂ∫îËØ•Â≠òÂÖ•Âì™‰∏™buf„ÄÇ
                     284     
                     285         
                     286     
                     287     
                     288     
                     289     
                     290     
                     291     
                     292     
                     293     
                     294         
0196                 295         KBSCNR1:
0196 75B0FF          296             MOV P3,#0FFH;
0199 C2B4            297             CLR P3.4;
019B E5B0            298             MOV A,P3;
019D 540F            299             ANL A,#0FH;
019F 640F            300             XRL A,#0FH;
01A1 6016            301             JZ KBSCNR2;
                     302             
01A3 7140            303             CALL DELAY4KBD;
                     304     
01A5 E5B0            305             MOV A,P3;
01A7 540F            306             ANL A,#0FH;
01A9 640F            307             XRL A,#0FH;
01AB 600C            308             JZ KBSCNR2;
01AD                 309         C11:
01AD 00              310             NOP;
01AE                 311         C12:
01AE 00              312             NOP;
01AF                 313         C13:
01AF 00              314             NOP;
01B0                 315         C14:
01B0 00              316             NOP;
                     317         
01B1                 318         WAT4RLS1:;WAITE FOR REALSE
01B1 E5B0            319             MOV A,P3;
01B3 540F            320             ANL A,#0FH;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 20:22:00 PAGE     6

01B5 640F            321             XRL A,#0FH;
01B7 70F8            322             JNZ WAT4RLS1;
                     323     
01B9                 324         KBSCNR2:
01B9 75B0FF          325             MOV P3,#0FFH;
01BC C2B5            326             CLR P3.5;
01BE E5B0            327             MOV A,P3;
01C0 540F            328             ANL A,#0FH;
01C2 640F            329             XRL A,#0FH;
01C4 6055            330             JZ KBSCNR3;
01C6 7140            331             CALL DELAY4KBD;
                     332     
01C8 E5B0            333             MOV A,P3;
01CA 540F            334             ANL A,#0FH;
01CC 640F            335             XRL A,#0FH;
01CE 604B            336             JZ KBSCNR3;
                     337     
01D0                 338         C21:
01D0 B40113          339             CJNE A,#01H,C22;0001Â∑¶‰∏äËßíË¢´Êåâ‰∏ã
                     340             
                     341     
                     342     
01D3 B90009          343             CJNE R1,#0,C21BUF2;
01D6 755407          344             MOV KEYBUF1,#07H;
01D9 B290            345             CPL P1.0;
01DB 7901            346             MOV R1,#1;
01DD 4113            347             AJMP WAT4RLS2;
01DF                 348         C21BUF2:
01DF 755307          349             MOV KEYBUF2,#07H;
01E2 7900            350             MOV R1,#0;
01E4 4113            351             AJMP WAT4RLS2;
01E6                 352         C22:
01E6 B40211          353             CJNE A,#02H,C23;
01E9 B90007          354             CJNE R1,#0,C22BUF2;
01EC 755404          355             MOV KEYBUF1,#04H;
01EF 7901            356             MOV R1,#1;
01F1 4113            357             AJMP WAT4RLS2;
01F3                 358         C22BUF2:
01F3 755304          359             MOV KEYBUF2,#04H;
01F6 7900            360             MOV R1,#0;
01F8 4113            361             AJMP WAT4RLS2;
01FA                 362         C23:
01FA B40411          363             CJNE A,#04H,C24;
01FD B90007          364             CJNE R1,#0,C23BUF2;
0200 755401          365             MOV KEYBUF1,#01H;
0203 7901            366             MOV R1,#1;
0205 4113            367             AJMP WAT4RLS2;
0207                 368         C23BUF2:
0207 755301          369             MOV KEYBUF2,#01H;
020A 7900            370             MOV R1,#0;
020C 4113            371             AJMP WAT4RLS2;
020E                 372         C24:
020E B40802          373             CJNE A,#08H,WAT4RLS2;
                     374             ;MOV KEYBUF1,#0FFH;
0211 610E            375             AJMP EXITSET;
                     376     
0213                 377         WAT4RLS2:;WAITE FOR REALSE
0213 E5B0            378             MOV A,P3;
0215 540F            379             ANL A,#0FH;
0217 640F            380             XRL A,#0FH;
0219 70F8            381             JNZ WAT4RLS2;
                     382     
                     383     
                     384     
                     385     
021B                 386         KBSCNR3:
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 20:22:00 PAGE     7

021B 75B0FF          387             MOV P3,#0FFH;
021E C2B6            388             CLR P3.6;
0220 E5B0            389             MOV A,P3;
0222 540F            390             ANL A,#0FH;
0224 640F            391             XRL A,#0FH;
0226 6060            392             JZ KBSCNR4;
0228 7140            393             CALL DELAY4KBD;
                     394     
022A E5B0            395             MOV A,P3;
022C 540F            396             ANL A,#0FH;
022E 640F            397             XRL A,#0FH;
0230 6056            398             JZ KBSCNR4;
                     399     
0232                 400         C31:
0232 B40111          401             CJNE A,#01H,C32;0001Â∑¶‰∏äËßíË¢´Êåâ‰∏ã
0235 B90007          402             CJNE R1,#0,C31BUF2;
0238 755408          403             MOV KEYBUF1,#08H;
023B 7901            404             MOV R1,#1;
023D 4180            405             AJMP WAT4RLS3;
023F                 406         C31BUF2:
023F 755308          407             MOV KEYBUF2,#08H;
0242 7900            408             MOV R1,#0;
0244 4180            409             AJMP WAT4RLS3;
0246                 410         C32:
0246 B40211          411             CJNE A,#02H,C33;
0249 B90007          412             CJNE R1,#0,C32BUF2;
024C 755405          413             MOV KEYBUF1,#05H;
024F 7901            414             MOV R1,#1;
0251 4180            415             AJMP WAT4RLS3;
0253                 416         C32BUF2:
0253 755305          417             MOV KEYBUF2,#05H;
0256 7900            418             MOV R1,#0;
0258 4180            419             AJMP WAT4RLS3;
025A                 420         C33:
025A B40411          421             CJNE A,#04H,C34;
025D B90007          422             CJNE R1,#0,C33BUF2;
0260 755402          423             MOV KEYBUF1,#02H;
0263 7901            424             MOV R1,#1;
0265 4180            425             AJMP WAT4RLS3;
0267                 426         C33BUF2:
0267 755302          427             MOV KEYBUF2,#02H;
026A 7900            428             MOV R1,#0;
026C 4180            429             AJMP WAT4RLS3;
026E                 430         C34:
026E B408A2          431             CJNE A,#08H,WAT4RLS2;
0271 B90007          432             CJNE R1,#0,C34BUF2;
0274 755400          433             MOV KEYBUF1,#00H;
0277 7901            434             MOV R1,#1;
0279 4180            435             AJMP WAT4RLS3;
027B                 436         C34BUF2:
027B 755300          437             MOV KEYBUF2,#00H;
027E 7900            438             MOV R1,#0;
                     439     
0280                 440         WAT4RLS3:;WAITE FOR REALSE
0280 E5B0            441             MOV A,P3;
0282 540F            442             ANL A,#0FH;
0284 640F            443             XRL A,#0FH;
0286 70F8            444             JNZ WAT4RLS3;
                     445     
0288                 446         KBSCNR4:
0288 75B0FF          447             MOV P3,#0FFH;
028B C2B7            448             CLR P3.7;
028D E5B0            449             MOV A,P3;
028F 540F            450             ANL A,#0FH;
0291 640F            451             XRL A,#0FH;
0293 6052            452             JZ KBSCNEND;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 20:22:00 PAGE     8

0295 7140            453             CALL DELAY4KBD;
                     454     
0297 E5B0            455             MOV A,P3;
0299 540F            456             ANL A,#0FH;
029B 640F            457             XRL A,#0FH;
029D 6048            458             JZ KBSCNEND;
                     459     
029F                 460         C41:
029F B40111          461             CJNE A,#01H,C42;0001Â∑¶‰∏äËßíË¢´Êåâ‰∏ã
02A2 B90007          462             CJNE R1,#0,C41BUF2;
02A5 755409          463             MOV KEYBUF1,#09H;
02A8 7901            464             MOV R1,#1;
02AA 41DF            465             AJMP WAT4RLS4;
02AC                 466         C41BUF2:
02AC 755309          467             MOV KEYBUF2,#09H;
02AF 7900            468             MOV R1,#0;
02B1 41DF            469             AJMP WAT4RLS4;
02B3                 470         C42:
02B3 B40211          471             CJNE A,#02H,C43;
02B6 B90007          472             CJNE R1,#0,C42BUF2;
02B9 755406          473             MOV KEYBUF1,#06H;
02BC 7901            474             MOV R1,#1;
02BE 41DF            475             AJMP WAT4RLS4;
02C0                 476         C42BUF2:
02C0 755306          477             MOV KEYBUF2,#06H;
02C3 7900            478             MOV R1,#0;
02C5 41DF            479             AJMP WAT4RLS4;
02C7                 480         C43:
02C7 B40411          481             CJNE A,#04H,C44;
02CA B90007          482             CJNE R1,#0,C43BUF2;
02CD 755403          483             MOV KEYBUF1,#03H;
02D0 7901            484             MOV R1,#1;
02D2 41DF            485             AJMP WAT4RLS4;
02D4                 486         C43BUF2:
02D4 755303          487             MOV KEYBUF2,#03H;
02D7 7900            488             MOV R1,#0;
02D9 41DF            489             AJMP WAT4RLS4;
02DB                 490         C44:
02DB B40801          491             CJNE A,#08H,WAT4RLS4;
02DE 00              492             NOP;
                     493     
02DF                 494         WAT4RLS4:;WAITE FOR REALSE
02DF E5B0            495             MOV A,P3;
02E1 540F            496             ANL A,#0FH;
02E3 640F            497             XRL A,#0FH;
02E5 70F8            498             JNZ WAT4RLS4;
                     499     
                     500     
                     501     
02E7                 502         KBSCNEND:
                     503     
02E7 C2A6            504             CLR P2.6;
02E9 D2A7            505             SETB P2.7;
02EB 7580FE          506             MOV P0,#0FEH;
02EE 7140            507             CALL DELAY4KBD;
02F0 C2A7            508             CLR P2.7;
02F2 D2A6            509             SETB P2.6;
02F4 900360          510             MOV DPTR,#TIMETAB;
02F7 E9              511             MOV A,R1;
02F8 600A            512             JZ DISBUF2; 
02FA E554            513             MOV A,KEYBUF1;
02FC 04              514             INC A;
02FD 93              515             MOVC A,@A+DPTR;
02FE F580            516             MOV P0,A;
0300 7140            517             CALL DELAY4KBD;
0302 610C            518             AJMP DISBUFEND;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 20:22:00 PAGE     9

0304                 519             DISBUF2:
0304 E553            520                 MOV A,KEYBUF2;
0306 04              521                 INC A;
0307 93              522                 MOVC A,@A+DPTR;
0308 F580            523                 MOV P0,A;
030A 7140            524                 CALL DELAY4KBD;
030C                 525             DISBUFEND:
                     526     
030C 2196            527             AJMP KBSCNR1;
030E                 528         EXITSET:
030E B297            529             CPL P1.7;
                     530             ;CPL P1.1;
                     531         
0310                 532         WAT4EXIT:;WAITE FOR REALSE
0310 E5B0            533             MOV A,P3;
0312 540F            534             ANL A,#0FH;
0314 640F            535             XRL A,#0FH;
0316 70F8            536             JNZ WAT4EXIT;
                     537     
                     538             
                     539     
                     540     
                     541     
                     542     
0318 E554            543             MOV A,KEYBUF1;
031A 75F00A          544             MOV B,#10;
031D A4              545             MUL AB;
031E 2553            546             ADD A,KEYBUF2;
0320 F552            547             MOV KEYBUF3,A;
                     548     
0322 C2D3            549             CLR RS0;USE THE DEFAULT SET OF REGISTERS;
0324 D0E0            550             POP ACC;
0326 D0D0            551             POP PSW;
                     552     
0328 855457          553             MOV OFFSET2,KEYBUF1;
                     554             
                     555     
                     556     
                     557     
                     558     
                     559     
032B AC53            560             MOV R4,KEYBUF2;
032D BC0005          561             CJNE R4,#00H,NDINC;
0330 855255          562             MOV DEFAULTDT,KEYBUF3;
0333 613A            563             AJMP NDINCBK;
0335                 564             NDINC:
                     565             ;MOV R5,KEYBUF3;
0335 0557            566             INC OFFSET2;‰∏∫‰ªÄ‰πàË¶ÅÂä†1ÔºåÂõ†‰∏∫Â≠òÊîæÊï∞Á†ÅÁÆ°ÂØπÂ∫î16ËøõÂà∂ÁöÑË°®ÊúÄÂâçÈù¢Â§
                             öÂä†‰∫Ü‰∏Ä‰∏™00H;
0337 855255          567             MOV DEFAULTDT,KEYBUF3;
033A                 568             NDINCBK:
                     569     
033A D28A            570             SETB IT1;
033C 75B00F          571             MOV P3,#0FH;
033F 32              572             RETI;
                     573     
                     574     
0340                 575         DELAY4KBD:
0340 7E0A            576             MOV R6,#10
0342                 577         D1:        
0342 7FF8            578             MOV R7,#248
0344 DFFE            579             DJNZ R7,$
0346 DEFA            580             DJNZ R6,D1
0348 22              581             RET
                     582     
                     583     
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 20:22:00 PAGE    10

                     584     
                     585     
                     586     
                     587     
                     588     
0349                 589     PWNWAT: ;power on wait
0349 C0D0            590             PUSH PSW;
034B C0E0            591             PUSH ACC;
034D D2D3            592             SETB RS0;
034F 7928            593             MOV R1,#40;
0351 7A0A            594             MOV R2,#10;
0353                 595         PW1:
0353 00              596             NOP;
0354 00              597             NOP;
0355 D9FC            598             DJNZ R1,PW1;
0357 7928            599             MOV R1,#40;
0359 DAF8            600             DJNZ R2,PW1;
035B D0E0            601             POP ACC;
035D D0D0            602             POP PSW;
035F 22              603             RET;
                     604     
                     605     
0360                 606     TIMETAB:
0360 003F065B        607         DB 00H,3FH,06H,5BH;
0364 4F666D7D        608         DB 4FH,66H,6DH,7DH;
0368 077F6F          609         DB 07H,7FH,6FH;
                     610         ;DB 6FH,7FH,07H,7DH;
                     611         ;DB 6DH,66H,4FH,5BH;
                     612         ;DB 06H,3FH;
                     613     END;
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 20:22:00 PAGE    11

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

ACC. . . . . . . .  D ADDR   00E0H   A   
ADJUST . . . . . .  C ADDR   00B4H   A   
ADJUST1. . . . . .  C ADDR   00BDH   A   
ADJUSTFLAG . . . .  N NUMB   0051H   A   
ASGTO. . . . . . .  C ADDR   00F2H   A   
B. . . . . . . . .  D ADDR   00F0H   A   
BAL1 . . . . . . .  C ADDR   0134H   A   
BAL2 . . . . . . .  C ADDR   014EH   A   
BAL3 . . . . . . .  C ADDR   0168H   A   
BALANCE. . . . . .  N NUMB   0056H   A   
BREAK. . . . . . .  C ADDR   0174H   A   
C11. . . . . . . .  C ADDR   01ADH   A   
C12. . . . . . . .  C ADDR   01AEH   A   
C13. . . . . . . .  C ADDR   01AFH   A   
C14. . . . . . . .  C ADDR   01B0H   A   
C21. . . . . . . .  C ADDR   01D0H   A   
C21BUF2. . . . . .  C ADDR   01DFH   A   
C22. . . . . . . .  C ADDR   01E6H   A   
C22BUF2. . . . . .  C ADDR   01F3H   A   
C23. . . . . . . .  C ADDR   01FAH   A   
C23BUF2. . . . . .  C ADDR   0207H   A   
C24. . . . . . . .  C ADDR   020EH   A   
C31. . . . . . . .  C ADDR   0232H   A   
C31BUF2. . . . . .  C ADDR   023FH   A   
C32. . . . . . . .  C ADDR   0246H   A   
C32BUF2. . . . . .  C ADDR   0253H   A   
C33. . . . . . . .  C ADDR   025AH   A   
C33BUF2. . . . . .  C ADDR   0267H   A   
C34. . . . . . . .  C ADDR   026EH   A   
C34BUF2. . . . . .  C ADDR   027BH   A   
C41. . . . . . . .  C ADDR   029FH   A   
C41BUF2. . . . . .  C ADDR   02ACH   A   
C42. . . . . . . .  C ADDR   02B3H   A   
C42BUF2. . . . . .  C ADDR   02C0H   A   
C43. . . . . . . .  C ADDR   02C7H   A   
C43BUF2. . . . . .  C ADDR   02D4H   A   
C44. . . . . . . .  C ADDR   02DBH   A   
CFG. . . . . . . .  C ADDR   00EDH   A   
CMP3 . . . . . . .  C ADDR   009BH   A   
CMP3INT. . . . . .  C ADDR   00D4H   A   
CMP5 . . . . . . .  C ADDR   00A0H   A   
CMP5INT. . . . . .  C ADDR   00DDH   A   
D1 . . . . . . . .  C ADDR   0342H   A   
DEF. . . . . . . .  C ADDR   0000H   A   
DEFAULTDT. . . . .  N NUMB   0055H   A   
DELAY. . . . . . .  C ADDR   011EH   A   
DELAY10MS. . . . .  C ADDR   0108H   A   
DELAY1S. . . . . .  C ADDR   0108H   A   
DELAY4KBD. . . . .  C ADDR   0340H   A   
DISBUF2. . . . . .  C ADDR   0304H   A   
DISBUFEND. . . . .  C ADDR   030CH   A   
EA . . . . . . . .  B ADDR   00A8H.7 A   
ET0. . . . . . . .  B ADDR   00A8H.1 A   
EX1. . . . . . . .  B ADDR   00A8H.2 A   
EXITSET. . . . . .  C ADDR   030EH   A   
IT1. . . . . . . .  B ADDR   0088H.2 A   
KBSCN. . . . . . .  C ADDR   0179H   A   
KBSCNEND . . . . .  C ADDR   02E7H   A   
KBSCNR1. . . . . .  C ADDR   0196H   A   
KBSCNR2. . . . . .  C ADDR   01B9H   A   
A51 MACRO ASSEMBLER  PIRTEST                                                              11/01/2019 20:22:00 PAGE    12

KBSCNR3. . . . . .  C ADDR   021BH   A   
KBSCNR4. . . . . .  C ADDR   0288H   A   
KEYBUF1. . . . . .  N NUMB   0054H   A   
KEYBUF2. . . . . .  N NUMB   0053H   A   
KEYBUF3. . . . . .  N NUMB   0052H   A   
LIGHT. . . . . . .  C ADDR   00A3H   A   
LIGHTTIME. . . . .  C ADDR   00C1H   A   
LOOP . . . . . . .  C ADDR   007DH   A   
LOOPTAG. . . . . .  N NUMB   0060H   A   
LOOPTIME . . . . .  N NUMB   0059H   A   
MAIN . . . . . . .  C ADDR   0060H   A   
NDINC. . . . . . .  C ADDR   0335H   A   
NDINCBK. . . . . .  C ADDR   033AH   A   
NOINT. . . . . . .  C ADDR   00E6H   A   
NUMDIS . . . . . .  C ADDR   012DH   A   
OFFSET1. . . . . .  N NUMB   0058H   A   
OFFSET2. . . . . .  N NUMB   0057H   A   
P0 . . . . . . . .  D ADDR   0080H   A   
P1 . . . . . . . .  D ADDR   0090H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
P3 . . . . . . . .  D ADDR   00B0H   A   
PSW. . . . . . . .  D ADDR   00D0H   A   
PW1. . . . . . . .  C ADDR   0353H   A   
PWNWAT . . . . . .  C ADDR   0349H   A   
PX1. . . . . . . .  B ADDR   00B8H.2 A   
RS0. . . . . . . .  B ADDR   00D0H.3 A   
SP . . . . . . . .  D ADDR   0081H   A   
TH0. . . . . . . .  D ADDR   008CH   A   
THT. . . . . . . .  N NUMB   00D8H   A   
TIMEOUT. . . . . .  C ADDR   0115H   A   
TIMETAB. . . . . .  C ADDR   0360H   A   
TL0. . . . . . . .  D ADDR   008AH   A   
TLT. . . . . . . .  N NUMB   00F0H   A   
TMOD . . . . . . .  D ADDR   0089H   A   
TR0. . . . . . . .  B ADDR   0088H.4 A   
WAT4EXIT . . . . .  C ADDR   0310H   A   
WAT4RLS. . . . . .  C ADDR   0184H   A   
WAT4RLS1 . . . . .  C ADDR   01B1H   A   
WAT4RLS2 . . . . .  C ADDR   0213H   A   
WAT4RLS3 . . . . .  C ADDR   0280H   A   
WAT4RLS4 . . . . .  C ADDR   02DFH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
